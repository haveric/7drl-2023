(self.webpackChunk_7drl_2023=self.webpackChunk_7drl_2023||[]).push([[143],{890:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(537),o=n.n(s),i=n(645),a=n.n(i)()(o());a.push([e.id,'* {\n    box-sizing: border-box;\n}\n\nbody {\n    margin: 0 auto;\n    overflow: hidden;\n    width: 100vw;\n    height: 100vh;\n    font-size: 1.2vh;\n}\n\n.ui {\n    display: block;\n    z-index: -1000 !important;\n    opacity: 0;\n    pointer-events: none;\n}\n\n.ui.active {\n    z-index: 0 !important;\n    opacity: 1;\n    pointer-events: all;\n}\n\n\n.details {\n    padding: 10px 15px;\n    font-size: 2vh;\n    display: block;\n    width: 20%;\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #ddd;\n}\n\n.details__header {\n    margin-top: 20px;\n}\n\n.details__line {\n    display: block;\n}\n\n.player-info {\n    height: calc(20vh - 10px);\n    border-bottom: 1px solid #000;\n}\n\n.view-info {\n    height: 30vh;\n    border-bottom: 1px solid #000;\n}\n\n.message-console {\n    position: relative;\n    height: calc(50vh - 10px);\n}\n\n.messages__wrap {\n    position: absolute;\n    opacity: 1;\n    padding: 15px 5px 5px;\n    width: 100%;\n    height: 100%;\n}\n\n.messages {\n    display:flex;\n    flex-direction:column-reverse;\n    height: 100%;\n    overflow-y: scroll;\n}\n\n\n.messages__inn {\n\n}\n\n.message {\n    font-size: 1.66vh;\n}\n\n.message__text {\n\n}\n\n.message__bold {\n    font-weight: bold;\n}\n\n.message__italics {\n    font-style: italic;\n}\n\n.message__amount {\n    margin-left: 1em;\n}\n\n\n.player-health,\n.hero-health {\n    position: relative;\n    width: 100%;\n    height: 2vh;\n    background-color: #000;\n}\n\n.player-health__fg,\n.hero-health__fg {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    background-color: #8B0000;\n}\n\n.player-health__text,\n.hero-health__text {\n    display: table;\n    position: absolute;\n    left: 0;\n    right: 0;\n    font-size: 1.8vh;\n    color: #fff;\n    margin: 0 auto;\n}\n\n.player-stat,\n.hero-stat {\n    display: inline-block;\n    float: left;\n    width: 50%;\n}\n\n.hero-info {\n    display: inline-block;\n    position: absolute;\n    left: 25.5%;\n    width: 24.5%;\n    padding: 15px;\n    font-size: 2vh;\n}\n\n.hero-status__message {\n    font-size: 2.5vh;\n}\n\n.inventory {\n    position: absolute;\n    top: 0;\n    right: 0;\n    width: 30%;\n    height: 80%;\n    transform: translateX(100%);\n    transition: transform 1s ease;\n    background: #fff;\n    padding: 15px;\n}\n\n.inventory.active {\n    transform: translateX(0);\n}\n\n.inventory__equipment {\n    width: 100%;\n    height: 55%;\n    display: grid;\n    grid-template-columns: repeat(3, minmax(0, 1fr));\n    grid-template-rows: repeat(4, minmax(0, 1fr));\n    background-color: #333;\n    grid-gap: 0.2vw;\n    padding: 1vh 7.5vh\n}\n\n.inventory__storage-wrap {\n    width: 100%;\n    height: 40%;\n    background-color: #333;\n    position: relative;\n    overflow-y: auto;\n}\n\n.inventory__storage {\n    width: 100%;\n    display: grid;\n    grid-template-columns: repeat(10, minmax(0, 1fr));\n    grid-gap: 0.2vw;\n    padding: 0.2vw;\n}\n\n.inventory__storage-title {\n    grid-column: span 10;\n    padding: 5px;\n    background-color: #ccc;\n    font-size: 1.8vh;\n}\n\n.slot {\n    background-color: gray;\n    text-align: center;\n    border-radius: 5px;\n    position: relative;\n    font-family: helvetica, serif;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.inventory__equipment-slot .item {\n    font-size: 7.5vh;\n}\n\n.inventory__equipment-slot:before {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    width: 100%;\n    height: 100%;\n    font-size: 7.5vh;\n    opacity: 0.15;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.inventory__equipment-slot.has-item:before {\n    display: none;\n}\n\n.inventory__equipment-slot[data-index="0"]:before {\n    content: "⌈";\n}\n\n.inventory__equipment-slot[data-index="1"]:before {\n    content: "∩";\n}\n\n.inventory__equipment-slot[data-index="2"]:before {\n    content: "ᴕ";\n}\n\n.inventory__equipment-slot[data-index="3"]:before {\n    content: "†";\n    transform: rotate(180deg);\n}\n\n.inventory__equipment-slot[data-index="4"]:before {\n    content: "☗";\n}\n\n.inventory__equipment-slot[data-index="5"]:before {\n    content: "●";\n}\n\n.inventory__equipment-slot[data-index="6"]:before,\n.inventory__equipment-slot[data-index="8"]:before {\n    content: "○";\n}\n\n.inventory__equipment-slot[data-index="7"]:before {\n    content: "-";\n}\n\n.inventory__equipment-slot[data-index="9"]:before {\n    content: "ひ";\n}\n\n.inventory__equipment-slot[data-index="10"]:before {\n    content: "◫";\n}\n.inventory__equipment-slot[data-index="11"]:before {\n    content: "″";\n}\n\n.inventory__storage-slot {\n    height: 5.3vh;\n}\n\n.slot.has-item:hover {\n    cursor: pointer;\n    background-color: #999;\n}\n\n.slot.disabled {\n    background-color: #845b5b;\n}\n\n.slot.dragging .item {\n    display: none;\n}\n\n.select-list,\n.trade-list {\n    background-color: #ccc;\n    border-radius: 5px;\n    padding: 15px;\n    position: absolute;\n    top: 0;\n    left: 0;\n    font-size: 1.5vh;\n}\n\n.select-list__title,\n.trade-list__title {\n    margin: 0;\n    padding-bottom: 5px;\n    border-bottom: 1px solid #666;\n    font-size: 2.5vh;\n}\n\n.select-list__option::marker,\n.trade-list__option::marker {\n    color: #000;\n}\n.select-list__option.active,\n.trade-list__option.active{\n    background-color: #1E90FF;\n    color: #fff;\n}\n\n.trade-list__option {\n    border: 1px dashed #666;\n    padding: 5px 10px;\n}\n\n.trade-list__left {\n    width: 50%;\n    float: left;\n    border-right: 1px solid #000;\n}\n\n.trade-list__right {\n    width: 50%;\n    float: left;\n\n}',"",{version:3,sources:["webpack://./src/styles/style.css"],names:[],mappings:"AAAA;IACI,sBAAsB;AAC1B;;AAEA;IACI,cAAc;IACd,gBAAgB;IAChB,YAAY;IACZ,aAAa;IACb,gBAAgB;AACpB;;AAEA;IACI,cAAc;IACd,yBAAyB;IACzB,UAAU;IACV,oBAAoB;AACxB;;AAEA;IACI,qBAAqB;IACrB,UAAU;IACV,mBAAmB;AACvB;;;AAGA;IACI,kBAAkB;IAClB,cAAc;IACd,cAAc;IACd,UAAU;IACV,kBAAkB;IAClB,MAAM;IACN,QAAQ;IACR,SAAS;IACT,sBAAsB;AAC1B;;AAEA;IACI,gBAAgB;AACpB;;AAEA;IACI,cAAc;AAClB;;AAEA;IACI,yBAAyB;IACzB,6BAA6B;AACjC;;AAEA;IACI,YAAY;IACZ,6BAA6B;AACjC;;AAEA;IACI,kBAAkB;IAClB,yBAAyB;AAC7B;;AAEA;IACI,kBAAkB;IAClB,UAAU;IACV,qBAAqB;IACrB,WAAW;IACX,YAAY;AAChB;;AAEA;IACI,YAAY;IACZ,6BAA6B;IAC7B,YAAY;IACZ,kBAAkB;AACtB;;;AAGA;;AAEA;;AAEA;IACI,iBAAiB;AACrB;;AAEA;;AAEA;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,kBAAkB;AACtB;;AAEA;IACI,gBAAgB;AACpB;;;AAGA;;IAEI,kBAAkB;IAClB,WAAW;IACX,WAAW;IACX,sBAAsB;AAC1B;;AAEA;;IAEI,kBAAkB;IAClB,MAAM;IACN,OAAO;IACP,SAAS;IACT,yBAAyB;AAC7B;;AAEA;;IAEI,cAAc;IACd,kBAAkB;IAClB,OAAO;IACP,QAAQ;IACR,gBAAgB;IAChB,WAAW;IACX,cAAc;AAClB;;AAEA;;IAEI,qBAAqB;IACrB,WAAW;IACX,UAAU;AACd;;AAEA;IACI,qBAAqB;IACrB,kBAAkB;IAClB,WAAW;IACX,YAAY;IACZ,aAAa;IACb,cAAc;AAClB;;AAEA;IACI,gBAAgB;AACpB;;AAEA;IACI,kBAAkB;IAClB,MAAM;IACN,QAAQ;IACR,UAAU;IACV,WAAW;IACX,2BAA2B;IAC3B,6BAA6B;IAC7B,gBAAgB;IAChB,aAAa;AACjB;;AAEA;IACI,wBAAwB;AAC5B;;AAEA;IACI,WAAW;IACX,WAAW;IACX,aAAa;IACb,gDAAgD;IAChD,6CAA6C;IAC7C,sBAAsB;IACtB,eAAe;IACf;AACJ;;AAEA;IACI,WAAW;IACX,WAAW;IACX,sBAAsB;IACtB,kBAAkB;IAClB,gBAAgB;AACpB;;AAEA;IACI,WAAW;IACX,aAAa;IACb,iDAAiD;IACjD,eAAe;IACf,cAAc;AAClB;;AAEA;IACI,oBAAoB;IACpB,YAAY;IACZ,sBAAsB;IACtB,gBAAgB;AACpB;;AAEA;IACI,sBAAsB;IACtB,kBAAkB;IAClB,kBAAkB;IAClB,kBAAkB;IAClB,6BAA6B;IAC7B,aAAa;IACb,uBAAuB;IACvB,mBAAmB;AACvB;;AAEA;IACI,gBAAgB;AACpB;;AAEA;IACI,kBAAkB;IAClB,MAAM;IACN,OAAO;IACP,QAAQ;IACR,SAAS;IACT,WAAW;IACX,YAAY;IACZ,gBAAgB;IAChB,aAAa;IACb,aAAa;IACb,uBAAuB;IACvB,mBAAmB;AACvB;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,YAAY;AAChB;;AAEA;IACI,YAAY;AAChB;;AAEA;IACI,YAAY;AAChB;;AAEA;IACI,YAAY;IACZ,yBAAyB;AAC7B;;AAEA;IACI,YAAY;AAChB;;AAEA;IACI,YAAY;AAChB;;AAEA;;IAEI,YAAY;AAChB;;AAEA;IACI,YAAY;AAChB;;AAEA;IACI,YAAY;AAChB;;AAEA;IACI,YAAY;AAChB;AACA;IACI,YAAY;AAChB;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,eAAe;IACf,sBAAsB;AAC1B;;AAEA;IACI,yBAAyB;AAC7B;;AAEA;IACI,aAAa;AACjB;;AAEA;;IAEI,sBAAsB;IACtB,kBAAkB;IAClB,aAAa;IACb,kBAAkB;IAClB,MAAM;IACN,OAAO;IACP,gBAAgB;AACpB;;AAEA;;IAEI,SAAS;IACT,mBAAmB;IACnB,6BAA6B;IAC7B,gBAAgB;AACpB;;AAEA;;IAEI,WAAW;AACf;AACA;;IAEI,yBAAyB;IACzB,WAAW;AACf;;AAEA;IACI,uBAAuB;IACvB,iBAAiB;AACrB;;AAEA;IACI,UAAU;IACV,WAAW;IACX,4BAA4B;AAChC;;AAEA;IACI,UAAU;IACV,WAAW;;AAEf",sourcesContent:['* {\n    box-sizing: border-box;\n}\n\nbody {\n    margin: 0 auto;\n    overflow: hidden;\n    width: 100vw;\n    height: 100vh;\n    font-size: 1.2vh;\n}\n\n.ui {\n    display: block;\n    z-index: -1000 !important;\n    opacity: 0;\n    pointer-events: none;\n}\n\n.ui.active {\n    z-index: 0 !important;\n    opacity: 1;\n    pointer-events: all;\n}\n\n\n.details {\n    padding: 10px 15px;\n    font-size: 2vh;\n    display: block;\n    width: 20%;\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #ddd;\n}\n\n.details__header {\n    margin-top: 20px;\n}\n\n.details__line {\n    display: block;\n}\n\n.player-info {\n    height: calc(20vh - 10px);\n    border-bottom: 1px solid #000;\n}\n\n.view-info {\n    height: 30vh;\n    border-bottom: 1px solid #000;\n}\n\n.message-console {\n    position: relative;\n    height: calc(50vh - 10px);\n}\n\n.messages__wrap {\n    position: absolute;\n    opacity: 1;\n    padding: 15px 5px 5px;\n    width: 100%;\n    height: 100%;\n}\n\n.messages {\n    display:flex;\n    flex-direction:column-reverse;\n    height: 100%;\n    overflow-y: scroll;\n}\n\n\n.messages__inn {\n\n}\n\n.message {\n    font-size: 1.66vh;\n}\n\n.message__text {\n\n}\n\n.message__bold {\n    font-weight: bold;\n}\n\n.message__italics {\n    font-style: italic;\n}\n\n.message__amount {\n    margin-left: 1em;\n}\n\n\n.player-health,\n.hero-health {\n    position: relative;\n    width: 100%;\n    height: 2vh;\n    background-color: #000;\n}\n\n.player-health__fg,\n.hero-health__fg {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    background-color: #8B0000;\n}\n\n.player-health__text,\n.hero-health__text {\n    display: table;\n    position: absolute;\n    left: 0;\n    right: 0;\n    font-size: 1.8vh;\n    color: #fff;\n    margin: 0 auto;\n}\n\n.player-stat,\n.hero-stat {\n    display: inline-block;\n    float: left;\n    width: 50%;\n}\n\n.hero-info {\n    display: inline-block;\n    position: absolute;\n    left: 25.5%;\n    width: 24.5%;\n    padding: 15px;\n    font-size: 2vh;\n}\n\n.hero-status__message {\n    font-size: 2.5vh;\n}\n\n.inventory {\n    position: absolute;\n    top: 0;\n    right: 0;\n    width: 30%;\n    height: 80%;\n    transform: translateX(100%);\n    transition: transform 1s ease;\n    background: #fff;\n    padding: 15px;\n}\n\n.inventory.active {\n    transform: translateX(0);\n}\n\n.inventory__equipment {\n    width: 100%;\n    height: 55%;\n    display: grid;\n    grid-template-columns: repeat(3, minmax(0, 1fr));\n    grid-template-rows: repeat(4, minmax(0, 1fr));\n    background-color: #333;\n    grid-gap: 0.2vw;\n    padding: 1vh 7.5vh\n}\n\n.inventory__storage-wrap {\n    width: 100%;\n    height: 40%;\n    background-color: #333;\n    position: relative;\n    overflow-y: auto;\n}\n\n.inventory__storage {\n    width: 100%;\n    display: grid;\n    grid-template-columns: repeat(10, minmax(0, 1fr));\n    grid-gap: 0.2vw;\n    padding: 0.2vw;\n}\n\n.inventory__storage-title {\n    grid-column: span 10;\n    padding: 5px;\n    background-color: #ccc;\n    font-size: 1.8vh;\n}\n\n.slot {\n    background-color: gray;\n    text-align: center;\n    border-radius: 5px;\n    position: relative;\n    font-family: helvetica, serif;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.inventory__equipment-slot .item {\n    font-size: 7.5vh;\n}\n\n.inventory__equipment-slot:before {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    width: 100%;\n    height: 100%;\n    font-size: 7.5vh;\n    opacity: 0.15;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.inventory__equipment-slot.has-item:before {\n    display: none;\n}\n\n.inventory__equipment-slot[data-index="0"]:before {\n    content: "⌈";\n}\n\n.inventory__equipment-slot[data-index="1"]:before {\n    content: "∩";\n}\n\n.inventory__equipment-slot[data-index="2"]:before {\n    content: "ᴕ";\n}\n\n.inventory__equipment-slot[data-index="3"]:before {\n    content: "†";\n    transform: rotate(180deg);\n}\n\n.inventory__equipment-slot[data-index="4"]:before {\n    content: "☗";\n}\n\n.inventory__equipment-slot[data-index="5"]:before {\n    content: "●";\n}\n\n.inventory__equipment-slot[data-index="6"]:before,\n.inventory__equipment-slot[data-index="8"]:before {\n    content: "○";\n}\n\n.inventory__equipment-slot[data-index="7"]:before {\n    content: "-";\n}\n\n.inventory__equipment-slot[data-index="9"]:before {\n    content: "ひ";\n}\n\n.inventory__equipment-slot[data-index="10"]:before {\n    content: "◫";\n}\n.inventory__equipment-slot[data-index="11"]:before {\n    content: "″";\n}\n\n.inventory__storage-slot {\n    height: 5.3vh;\n}\n\n.slot.has-item:hover {\n    cursor: pointer;\n    background-color: #999;\n}\n\n.slot.disabled {\n    background-color: #845b5b;\n}\n\n.slot.dragging .item {\n    display: none;\n}\n\n.select-list,\n.trade-list {\n    background-color: #ccc;\n    border-radius: 5px;\n    padding: 15px;\n    position: absolute;\n    top: 0;\n    left: 0;\n    font-size: 1.5vh;\n}\n\n.select-list__title,\n.trade-list__title {\n    margin: 0;\n    padding-bottom: 5px;\n    border-bottom: 1px solid #666;\n    font-size: 2.5vh;\n}\n\n.select-list__option::marker,\n.trade-list__option::marker {\n    color: #000;\n}\n.select-list__option.active,\n.trade-list__option.active{\n    background-color: #1E90FF;\n    color: #fff;\n}\n\n.trade-list__option {\n    border: 1px dashed #666;\n    padding: 5px 10px;\n}\n\n.trade-list__left {\n    width: 50%;\n    float: left;\n    border-right: 1px solid #000;\n}\n\n.trade-list__right {\n    width: 50%;\n    float: left;\n\n}'],sourceRoot:""}]);const r=a},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",s=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),s&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),s&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,s,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(s)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var h=[].concat(e[c]);s&&a[h[0]]||(void 0!==i&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=i),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),o&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=o):h[4]="".concat(o)),t.push(h))}},t}},537:e=>{"use strict";e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var s=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),i="/*# ".concat(o," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},379:e=>{"use strict";var t=[];function n(e){for(var n=-1,s=0;s<t.length;s++)if(t[s].identifier===e){n=s;break}return n}function s(e,s){for(var i={},a=[],r=0;r<e.length;r++){var l=e[r],c=s.base?l[0]+s.base:l[0],h=i[c]||0,d="".concat(c," ").concat(h);i[c]=h+1;var p=n(d),m={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(m);else{var u=o(m,s);s.byIndex=r,t.splice(r,0,{identifier:d,updater:u,references:1})}a.push(d)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=s(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var r=n(i[a]);t[r].references--}for(var l=s(e,o),c=0;c<i.length;c++){var h=n(i[c]);0===t[h].references&&(t[h].updater(),t.splice(h,1))}i=l}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var s=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(n)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var s="";n.supports&&(s+="@supports (".concat(n.supports,") {")),n.media&&(s+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(s+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),s+=n.css,o&&(s+="}"),n.media&&(s+="}"),n.supports&&(s+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},734:(e,t,n)=>{"use strict";var s=n(379),o=n.n(s),i=n(795),a=n.n(i),r=n(569),l=n.n(r),c=n(565),h=n.n(c),d=n(216),p=n.n(d),m=n(589),u=n.n(m),_=n(890),g={};g.styleTagTransform=u(),g.setAttributes=h(),g.insert=l().bind(null,"head"),g.domAPI=a(),g.insertStyleElement=p(),o()(_.Z,g),_.Z&&_.Z.locals&&_.Z.locals;class f{constructor(e){this.entity=e}perform(){console.error("Not Implemented")}}class v extends f{constructor(e){super(e)}perform(){return this}}class b extends f{constructor(e,t){super(e),this.reason=t}perform(){return this}}class y{constructor(e,t,n){this.text=e,this.color=t||"#333",this.bold=!1,this.italics=!1,n&&(this.bold=n.bold||!1,this.italics=n.italics||!1)}isEqual(e){return this.text===e.text&&this.color===e.color&&this.bold===e.bold&&this.italics===e.italics}}class A{constructor(e=[]){this.subMessages=e,this.count=1}isEqual(e){if(this.subMessages.length!==e.length)return!1;for(let t=0;t<this.subMessages.length;t++){const n=this.subMessages[t],s=e[t];if(!n.isEqual(s))return!1}return!0}getHtml(){const e=document.createElement("div");e.classList.add("message");for(const t of this.subMessages){const n=document.createElement("span");n.classList.add("message__text"),t.bold&&n.classList.add("message__bold"),t.italics&&n.classList.add("message__italics"),n.innerText=t.text,n.style.color=t.color,e.appendChild(n)}return this.count>1&&e.appendChild(this.getCountHtml()),e}getCountHtml(){const e=document.createElement("span");return e.classList.add("message__amount"),e.innerText="x"+this.count,e}}class w{constructor(e){this.dom=this.htmlToElement(e)}htmlToElement(e){const t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}appendTo(e){e.appendChild(this.dom)}isOpen(){return this.dom.classList.contains("active")}open(){this.dom.classList.contains("active")||this.dom.classList.add("active")}close(){this.dom.classList.remove("active")}}const x=new class extends w{constructor(){super('<div class="ui message-console">\n    <div class="messages__wrap">\n        <div class="messages">\n            <div class="messages__inn"></div>\n        </div>\n    </div>\n</div>'),this.messagesInnerDom=this.dom.getElementsByClassName("messages__inn")[0]}updateLastMessageCount(e){const t=document.querySelectorAll(".message:last-child")[0],n=t.querySelectorAll(".message__amount")[0];n?n.innerText="x"+e.count:t.appendChild(e.getCountHtml())}addMessage(e){this.messagesInnerDom.appendChild(e)}clear(){this.messagesInnerDom.innerHTML=""}},k=new class{constructor(){this.messages=[],this.builder=[]}text(e,t,n){return this.builder.push(new y(e,t,n)),this}build(e=!0){this.addMessage(this.builder.slice(0),e),this.builder=[]}clear(){this.messages=[],x.clear()}addMessage(e,t=!0){if(t&&this.messages.length>0){const t=this.messages[this.messages.length-1];t.isEqual(e)?(t.count+=1,x.updateLastMessageCount(t)):this.addNewMessage(e)}else this.addNewMessage(e)}addNewMessage(e){const t=new A(e);this.messages.push(t),x.addMessage(t.getHtml())}},C=k,I=new class extends w{constructor(){super('<div class="ui view-info">\n\n</div>')}updatePlayerDetails(e,t){const n=e.getComponent("position"),s=t.tiles[n.x.get()][n.y.get()];this.updatePositionDetails(s)}getDetailsLine(e){return"<span class='details__line'>"+e+"</span>"}updatePositionDetails(e){let t;t=e.getComponent("fov")?.isExplored()?this.getDetailsLine(e.name):this.getDetailsLine("You haven't explored here."),this.dom.innerHTML=t}};class M{constructor(e,t){this.name=e,this.image=t}}class B{constructor(){this.textures=[]}addTexture(e,t){const n=this,s=new Image;s.onload=function(){n.textures.push(new M(e,s))},s.src=t}getTexture(e){const t=this.textures.length;for(let n=0;n<t;n++)if(this.textures[n].name===e)return this.textures[n].image;return null}loadJson(e,t){const n=t.tileSize,s=t.name,o=t.width,i=t.tiles;let a=0,r=0;for(const t of i)Ht.spriteManager.addImage(s+"_"+t,e,r*n,a*n),r++,r>=o&&(r-=o,a++)}}class E{constructor(e,t,n,s,o,i){this.imageName=e,this.textureName=t,this.texture=Ht.textureManager.getTexture(t),this.x=n,this.y=s,this.w=o||64,this.h=i||64}loadTexture(){return null===this.texture&&(this.texture=Ht.textureManager.getTexture(this.textureName)),null!==this.texture}drawImage(e,t,n,s){null!==s&&s>0?(e.save(),e.translate((t+this.w/2)*Ht.scale,(n+this.h/2)*Ht.scale),e.rotate(s*Math.PI/180),e.drawImage(this.texture,this.x,this.y,this.w,this.h,-this.w/2*Ht.scale,-this.h/2*Ht.scale,this.w*Ht.scale,this.h*Ht.scale),e.restore()):e.drawImage(this.texture,this.x,this.y,this.w,this.h,t*Ht.scale,n*Ht.scale,this.w*Ht.scale,this.h*Ht.scale)}}class T{constructor(){this.sprites=[],this.spritesPreloaded=!1}addImage(e,t,n,s,o,i){this.sprites.push(new E(e,t,n,s,o,i))}getImage(e){const t=this.sprites.length;for(let n=0;n<t;n++)if(this.sprites[n].imageName===e)return this.sprites[n];return null}preloadSprites(){if(!this.spritesPreloaded){const e=this.sprites.length;let t=0;this.sprites.forEach((function(e){e.loadTexture()&&t++})),t===e&&(this.spritesPreloaded=!0)}return this.spritesPreloaded}}const S=n.p+"25dbe165d77e35f10dd9.gif",D=n.p+"5c5b2bc2ae027c4c410f.gif",z=n.p+"faa4b7a1876d79a2e697.png",L=JSON.parse('{"tileSize":64,"width":14,"name":"scribble","tiles":["tile","floor_path_curve","floor_wall_corner","floor_wall","floor_door_closed","floor_crate_small","floor_table","grass","path_curve","wall_corner","wall","door_closed","crate_small","table","tiles","floor_path","floor_wall_curve","floor_wall_half","floor_doorway","floor_barrel","floor_chair","crate","path","wall_curve","wall_half","doorway","barrel","chair","tiles_corner","floor_path_crossing","floor_wall_diagonal","floor_wall_damaged","floor_door_open","floor_barrels","floor_planks","trap_door","path_crossing","wall_diagonal","wall_damaged","door_open","barrels","planks","tiles_center","floor_track_curve","floor_wall_edge","floor_wall_secret","floor_trap","floor_barrels_stacked","floor_bed_luxurious","stairs_down","track_curve","wall_edge","wall_secret","trap","barrels_stacked","bed_luxurious","tiles_decorative","floor_track","floor_inner_round","floor_wall_trap","floor_chest","floor_arrow_curve","floor_bed","stairs_down_detail","track","inner_round","wall_trap","chest","arrow_curve","bed","tiles_cracked","floor_track_crossing","floor_inner_diagonal","floor_wall_demolished","floor_campfire","floor_arrow","floor_coffin","bridge","track_crossing","inner_diagonal","wall_demolished","campfire","arrow","coffin","wood","floor_track_cart","floor_inner_long_round","floor_trapdoor_square","floor_plants","floor_arrow_head","floor_puddle","bridge_end","track_cart","inner_long_round","trapdoor_square","plants","arrow_head","puddle","water","floor_cart","floor_inner_long_diagonal","floor_trapdoor_round","floor_tree","floor_arrow_circle","floor_dragon","carpet","cart","inner_long_diagonal","trapdoor_round","tree","arrow_circle","dragon","red_character","red_hand","purple_character","purple_hand","yellow_character","yellow_hand","green_character","green_hand","wall_full","blood_3","blood_2","blood_1","blank_0_4","blank_0_5","weapon_dagger","weapon_sword","weapon_longsword","weapon_pole","weapon_spear","weapon_bow_arrow","weapon_bow","weapon_arrow","blank_1_0","blank_1_1","blank_1_2","blank_1_3","blank_1_4","blank_1_5","weapon_axe_blades","weapon_axe_large","weapon_axe_double","weapon_axe","weapon_hammer","weapon_staff","shield_curved","shield_straight","blank_2_0","blank_2_1","blank_2_2","blank_2_3","blank_2_4","blank_2_5"]}'),N=n.p+"baf6200e3e3da9d03374.png",F=JSON.parse('{"tileSize":64,"width":2,"name":"webs","tiles":["cobweb_large","cobweb"]}'),O=n.p+"4a083d3aa277d83d586b.png",q=JSON.parse('{"tileSize":64,"width":30,"name":"rltiles","tiles":["shade","earth_elemental","fire_elemental","fog_cloud","death_cob","asmodeus","cerebov","dispater","ereshkigal","geryon","gloorx_vloq","lom_lobon","mnoleg","pandemonium_demon","shocking_sphere","flaming_sphere","balrog","blue_death","cacodemon","executioner","fiend","green_death","ice_fiend","pit_fiend","shadow_fiend","ice_devil","lorocyproca","reaper","soul_eater","sun_demon","blue_devil","demonic_crawler","hellion","hellwing","iron_devil","neqoxec","orange_demon","shadow_demon","tormentor","ynoxinul","beast","hairy_devil","red_devil","rotting_devil","smoke_demon","imp","lemure","manes","midge","shadow_imp","ufetubus","white_imp","clay_golem","glass_golem","electric_golem","iron_golem","stone_golem","toenail_golem","wood_golem","big_fish","electrical_eel","giant_goldfish","lava_fish","adolf","agnes","donald","duane","edmund","erica","frances","francis","glowing_shapeshifter","harold","hell_knight","human","jessica","joseph","josephine","jozef","killer_klown","louise","margery","maud","michael","necromancer","norbert","norris","psyche","rupert","shapeshifter","sigmund","terence","vault_guard","wayne","wizard","angel","boring_beetle","boulder_beetle","giant_beetle","program_bug","orion","cyclops","ettin","fire_giant","frost_giant","hill_giant","stone_giant","titan","green_dragon","golden_dragon","hydra1","hydra2","hydra3","hydra4","hydra5","white_dragon","iron_dragon","quicksilver_dragon","serpent_of_hell","black_dragon","skeletal_dragon","blue_dragon","swamp_dragon","wyvern","xtahua","efreet","blink_frog","giant_brown_frog","giant_frog","spiny_frog","eye_of_devastation","eye_of_draining","floating_eye","giant_orange_brain","gas_spore","great_orb_of_eyes","shining_eye","griffon","hippogriff","sphinx","ice_beast","acid_blob","spotted_jelly","brown_pudding","death_ooze","giant_amoeba","jelly","jellyfish","gray_ooze","pulsating_lump","lump_of_royal_jelly","green_slime","big_kobold","kobold","kobold_demonologist","ancient_lich","boris","lich","greater_mummy","guardian_mummy","mummy","mummy_priest","naga0","greater_naga0","naga_warrior0","guardian_naga","naga_mage","erolcha","ogre","ogre_mage","two_headed_ogre","oklob_plant","plant","queen_ant","queen_bee","rakshasa","rakshasa_fake","black_snake","brown_snake","grey_snake","lava_snake","salamander","garter_snake","snake","yellow_snake","water_troll","iron_troll","rock_troll","snorg","troll","bear","black_bear","grizzly_bear","polar_bear","vampire","vampire_knight","vampire_mage","freezing_wraith","shadow_wraith","spectral_thing","spectral_warrior","barrow_wight","wraith","juiblex","abomination_large1","abomination_large2","abomination_large3","abomination_large4","abomination_large5","abomination_large6","orb_guardian","tentacled_monstrosity","death_yak","sheep","yak","simulacrum_large","skeleton","giant_zombie","giant_ant","giant_cockroach","soldier_ant","butterfly","butterfly1","butterfly2","butterfly3","butterfly4","butterfly5","butterfly6","giant_bat","plains_centaur","centaur_warrior","yaktaur","yaktaur_captain","firedrake","lindwurm","mottled_dragon","steam_dragon","swamp_drake","elf","deep_elf_fighter0","deep_elf_soldier0","deep_elf_knight0","deep_elf_mage","deep_elf_sorcerer","deep_elf_conjurer","deep_elf_death_mage","deep_elf_demonologist","deep_elf_summoner","deep_elf_annihilator","deep_elf_priest","deep_elf_high_priest","fungus","wandering_mushroom","goblin0","hobgoblin0","gnoll0","ijyb","boggart","gargoyle","metal_gargoyle","molten_gargoyle","hell_hog","hell_hound","hog","hound","warg","war_dog","wolf","jackal","bumblebee","killer_bee","gecko","giant_iguana","giant_lizard","newt","gila_monster","komodo_dragon","elephant_slug","giant_slug","giant_snail","manticore","minotaur","ghoul","necrophage","rotting_hulk","orc0","orc_warrior0","orc_knight0","orc_warlord0","blork_the_orc0","urug0","orc_priest","orc_high_priest","orc_sorcerer","orc_wizard","flayed_ghost","hungry_ghost","insubstantial_wisp","phantom","ghost","quasit","green_rat","sewer_rat","orange_rat","quokka","rat","centipede","giant_mite","redback","scorpion","giant_spider","ugly_thing","very_ugly_thing","air_elemental","fire_vortex","spatial_vortex","killer_bee_larva","brain_worm","lava_worm","spiny_worm","swamp_worm","worm","abomination_small","unseen_horror","giant_blowfly","giant_mosquito","moth_of_wrath","red_wasp","curse_skull","curse_toe","flying_skull","simulacrum_small","skeletal_warrior","orc_zombie","water_elemental","fire_ant","quivering_blob","gelatinous_cube","chickatrice","cockatrice","pyrolisk","fox","coyote","werejackal","little_dog","dog","large_dog","dingo","werewolf","winter_wolf_cub","winter_wolf","hell_hound_pup","cerberus","freezing_sphere","beholder","kitten","housecat","jaguar","lynx","panther","large_cat","tiger","gremlin","winged_gargoyle","hobbit","dwarf","bugbear","dwarf_lord","dwarf_king","mind_flayer","master_mind_flayer","homunculus","tengu","blue_jelly","ochre_jelly","large_kobold","kobold_lord","kobold_shaman","leprechaun","small_mimic","large_mimic","giant_mimic","wood_nymph","water_nymph","mountain_nymph","goblin","hobgoblin","orc","hill_orc","mordor_orc","uruk-hai","orc_shaman","orc-captain","rock_piercer","iron_piercer","glass_piercer","rothe","mumak","leocrotta","wumpus","titanothere","baluchitherium","mastodon","giant_rat","rabid_rat","wererat","rock_mole","woodchuck","cave_spider","lurker_above","trapper","white_unicorn","gray_unicorn","black_unicorn","pony","horse","warhorse","dust_vortex","ice_vortex","energy_vortex","steam_vortex","baby_long_worm","baby_purple_worm","long_worm","purple_worm","grid_bug","xan","yellow_light","black_light","zruty","couatl","aleax","ki-rin","archon","bat","raven","vampire_bat","forest_centaur","mountain_centaur","baby_gray_dragon","baby_silver_dragon","baby_shimmering_dragon","baby_red_dragon","baby_white_dragon","baby_orange_dragon","baby_black_dragon","baby_blue_dragon","baby_green_dragon","baby_yellow_dragon","gray_dragon","silver_dragon","shimmering_dragon","red_dragon","orange_dragon","yellow_dragon","stalker","lichen","brown_mold","yellow_mold","green_mold","red_mold","shrieker","violet_fungus","gnome","gnome_lord","gnomish_wizard","gnome_king","giant","storm_giant","jabberwock","vorpal_jabberwock","keystone_kop","kop_sergeant","kop_lieutenant","kop_kaptain","demilich","master_lich","arch-lich","kobold_mummy","gnome_mummy","orc_mummy","dwarf_mummy","elf_mummy","human_mummy","ettin_mummy","giant_mummy","red_naga_hatchling","black_naga_hatchling","golden_naga_hatchling","guardian_naga_hatchling","red_naga","black_naga","golden_naga","ogre_lord","ogre_king","black_pudding","quantum_mechanic","rust_monster","disenchanter","water_moccasin","pit_viper","python","cobra","ice_troll","olog-hai","umber_hulk","vampire_lord","vlad_the_impaler","nazgul","xorn","monkey","ape","owlbear","yeti","carnivorous_ape","sasquatch","kobold_zombie","gnome_zombie","dwarf_zombie","elf_zombie","human_zombie","ettin_zombie","straw_golem","paper_golem","rope_golem","gold_golem","leather_golem","flesh_golem","woodland-elf","green-elf","grey-elf","elf-lord","elvenking","doppelganger","nurse","shopkeeper","guard","prisoner","oracle","aligned_priest","high_priest","soldier","sergeant","lieutenant","captain","watchman","watch_captain","medusa","wizard_of_yendor","croesus","charon","water_demon","horned_devil","succubus","incubus","erinys","barbed_devil","marilith","vrock","hezrou","bone_devil","nalfeshnee","yeenoghu","orcus","baalzebub","demogorgon","death","pestilence","famine","mail_daemon","djinni","sandestin","piranha","shark","giant_eel","electric_eel","kraken","iguana","baby_crocodile","lizard","chameleon","crocodile","long_worm_tail","archeologist","barbarian","caveman","cavewoman","healer","knight","monk","priest","priestess","ranger","rogue","samurai","tourist","valkyrie","lord_carnarvon","pelias","shaman_karnov","earendil","elwing","hippocrates","king_arthur","grand_master","arch_priest","master_of_thieves","lord_sato","twoflower","norn","wizard_of_balance","minion_of_huhetotl","thoth_amon","chromatic_dragon","goblin_king","ixoth","master_kaen","nalzok","scorpius","master_assassin","ashikaga_takauji","lord_surtur","dark_one","student","chieftain","neanderthal","high-elf","attendant","page","abbot","acolyte","hunter","thug","ninja","roshi","guide","warrior","apprentice","invisible_monster","strange_object","spwpn_singing_sword","spwpn_wrath_of_trog","spwpn_scythe_of_curses","spwpn_mace_of_variability","spwpn_glaive_of_prune","spwpn_sceptre_of_torment","spwpn_sword_of_zonguldrok","spwpn_sword_of_cerebov","spwpn_staff_of_dispater","spwpn_sceptre_of_asmodeus","spwpn_sword_of_power","spwpn_knife_of_accuracy","spwpn_staff_of_olgreb","spwpn_vampires_tooth","quarterstaff","urand_bloodbane","urand_fkaming_death","urand_brilliance","urand_leech","urand_chilly_death","urand_morg","urand_finisher","urand_punk","urand_krishna","urand_skullcrusher","urand_guard","urand_jihad","urand_fiery_devil","urand_doom_knight","urand_eos","urand_voo_doo","urand_octopus_king","urand_arga","urand_elemental","urand_sniper","urand_erchidel","urand_plutonium","urand_undeadhunter","urand_ignorance","urand_zin","urand_augmentation","urand_thief","urand_bullseye","urand_dyrovepreva","urand_misfortune","urand_flash","urand_assassin","urand_lear","urand_zhor","urand_salamander","urand_war","urand_resistance","urand_folly","urand_edison","urand_dragonmask","urand_night","urand_dragon_king","urand_alchemist","urand_fencer","urand_shadows","urand_shaolin","urand_robustness","urand_mage","urand_cekugob","urand_four_winds","urand_bloodlust","club","mace2","mace_large","mace_large2","flail2","flail","flail_angmar","morningstar2","eveningstar","hammer","ancus","bullwhip","demon_whip","giant_club","giant_spiked_club","knife","dagger","orcish_dagger","elven_dagger","short_sword","short_sword2","orcish_short_sword","elven_short_sword","long_sword2","long_sword3","orcish_long_sword","greatsword","greatsword2","orcish_great_sword","falchion","scimitar","silver_saber","sabre2","quickblade","katana2","katana3","double_sword","triple_sword","demon_blade","hand_axe","war_axe","battle_axe2","broad_axe2","battle_axe","battle_axe3","executioner_axe","executioner_axe2","blowgun","sling","bow","crossbow","crossbow2","glaive","orcish_glaive","elven_spear","spear2","halberd","scythe","trident","demon_trident","stone","ya","arrow0","arrow1","arrow2","arrow3","arrow4","arrow5","arrow6","arrow7","crossbow_bolt","bolt0","bolt1","bolt2","bolt3","bolt4","bolt5","bolt6","bolt7","dart","dart-p","dart0","dart1","dart2","dart3","dart4","dart5","dart6","dart7","needle","needle-p","needle0","needle1","needle2","needle3","needle4","needle5","needle6","needle7","rock","robe","robe2","robe3","leather_armor2","breast_plate2","leather_armor4","orcish_leather_armor","elven_leather_armor","ring_mail","ring_mail2","orcish_ringmail","elven_ringmail","dwarven_ringmail","scale_mail","scale_mail2","elven_scalemail","chain_mail1","chain_mail2","orcish_chain_mail","splint_mail","banded_mail","plate_mail2","orcish_platemail","crystal_plate_mail","animal_skin","animal_skin2","troll_hide","troll_leather_armour","green_dragon_scales","green_dragon_scale_mail","ice_dragon_hide","ice_dragon_armour","silver_dragon_scales","silver_dragon_scale_mail","mottled_dragon_hide","mpttled_dragon_armour","blue_dragon_scales","blue_dragon_scale_mail","gold_dragon_hide","gold_dragon_armour","swamp_dragon_hide","swamp_dragon_armour","elven_shield","shield_kite2","shield_round2","small_shield","small_shield2","large_shield","shield_large2","shield_kite3","leather_cloak","cloak2","cloak3","cloak4","elven_leather_helm","wizard_hat","wizard_hat2","visored_helmet","etched_helmet","helm3","helm_visor1","glove1","glove3","glove5","gauntlet2","boots_brown1","jackboots","boots_stripe1","boots_green2","gem_iron","gem_brass","gem_bone","gem_wood","gem_copper","gem_gold","gem_silver","gem_bronze","gem_ivory","gem_glass","gem_lead","gem_plastic","i-flame","i-frost","i-slowing","i-hasting","i-magic_darts","i-healing","i-paralysis","i-fire","i-cold","i-confusion","i-invisibility","i-digging","i-fireball","i-teleportation","i-lightning","i-polymorph_other","i-enslavement","i-draining","i-random_effects","i-disintegration","tripe_ration","bread_ration","pear","apple","choko","honeycomb","snozzcumber","pizza","apricot","orange","banana","strawberry","rambutan","lemon","grape","sultana","lychee","beef_jerky","cheese","sausage","corpse","corpse_rotten","bone","kernod_wel","i-identify","i-fear","i-noise","i-remove_curse","i-detect_curse","i-summoning","i-enchant-weapon1","i-enchant_armour","i-torment","i-random_uselessness","i-curse_weapon","i-curse_armour","i-immolation","i-blinking","blank_paper","i-magic_mapping","i-foregetfulness","i-acquirement","i-enchant-weapon2","i-vorpalize-weapon","i-recharging","i-enchant-weapon3","wooden","silver","gold","iron","steel","bronze","brass","copper","granite","ivory","clay","tiger_eye","jade","glass","agate","diamond","emerald","gold_green","gold_red","opal","pearl","coral","gold_blue","plain_red","plain_yellow","plain_black","moonstone","crystal_white","stone3_blue","face1_gold","stone3_green","stone2_red","eye_magenta","face2","penta_orange","celtic_red","cameo_blue","bone_gray","cylinder_gray","ring_green","ring_cyan","crystal_green","cameo_orange","celtic_blue","eye_cyan","penta_green","ring_red","stone1_cyan","stone1_pink","stone2_green","stone3_magenta","celtic_yellow","stone1_green","stone2_blue","crystal_red","eye_green","clear","brilliant_blue","black","cyan","magenta","dark","ruby","yellow","brown","pink","white","i-heal","i-heal-wounds","i-speed","i-might","i-gain-strength","i-gain-dexterity","i-gain-intelligence","i-levitation","i-poison","i-porridge","i-degeneration","i-decay","i-water","i-experience","i-magic","i-restore-abilities","i-strong-poison","i-berserk-rage","i-cure-mutation","i-mutation","book_of_the_dead","dark_blue","dark_green","red","purple","tan","light_gray","dark_gray","light_blue","light_green","turquoise","parchment","leather","plaid","light_brown","dark_brown","glittering","metal_blue","metal_cyan","metal_green","cloth","staff00","staff01","staff02","staff03","staff04","staff05","staff06","staff07","staff08","staff09","misc_orb","misc_bottle","misc_crystal","misc_fan","misc_lamp","misc_stone","misc_lantern","misc_horn","misc_box","misc_deck","misc_disc","misc_rune","misc_altar","gold_piece","arrow","elven_arrow","orcish_arrow","silver_arrow","shuriken","boomerang","spear","orcish_spear","dwarvish_spear","silver_spear","javelin","silver_dagger","athame","scalpel","stiletto","worm_tooth","crysknife","axe","dwarvish_short_sword","broadsword","elven_broadsword","long_sword","two_handed_sword","katana","tsurugi","runesword","partisan","ranseur","spetum","lance","bardiche","voulge","dwarvish_mattock","fauchard","guisarme","bill_guisarme","lucern_hammer","bec_de_corbin","mace","morning_star","war_hammer","rubber_hose","aklys","elven_bow","orcish_bow","yumi","orcish_helm","dwarvish_iron_helm","fedora","cornuthaum","dunce_cap","dented_pot","plumed_helmet","crested_helmet","gray_dragon_scale_mail","shimmering_dragon_scale_mail","red_dragon_scale_mail","white_dragon_scale_mail","orange_dragon_scale_mail","black_dragon_scale_mail","yellow_dragon_scale_mail","gray_dragon_scales","shimmering_dragon_scales","red_dragon_scales","white_dragon_scales","orange_dragon_scales","black_dragon_scales","yellow_dragon_scales","plate_mail","bronze_plate_mail","dwarvish_mithril_coat","elven_mithril_coat","chain_mail","studded_leather_armor","orcish_ring_mail","leather_armor","leather_jacket","hawaiian_shirt","t_shirt","mummy_wrapping","elven_cloak","orcish_cloak","dwarvish_cloak","oilskin_cloak","alchemy_smock","tattered_cape","opera_cloak","ornamental_cope","piece_of_cloth","uruk_hai_shield","orcish_shield","dwarvish_roundshield","shield_of_reflection","old_gloves","padded_gloves","riding_gloves","fencing_gloves","low_boots","iron_shoes","combat_boots","jungle_boots","hiking_boots","mud_boots","buckled_boots","riding_boots","snow_boots","black_onyx","topaz","sapphire","twisted","wire","engagement","shiny","circular","spherical","oval","triangular","pyramidal","square","concave","hexagonal","octagonal","amulet_of_yendor","large_box","chest","ice_box","sack","skeleton_key","lock_pick","credit_card","tallow_candle","wax_candle","brass_lantern","lamp","expensive_camera","mirror","crystal_ball","lenses","blindfold","towel","saddle","leash","stethoscope","tinning_kit","tin_opener","can_of_grease","figurine","magic_marker","land_mine","beartrap","whistle","flute","horn","harp","bell","bugle","drum","pick_axe","grappling_hook","unicorn_horn","candelabrum_of_invocation","bell_of_opening","egg","meatball","meat_stick","huge_chunk_of_meat","meat_ring","kelp_frond","eucalyptus_leaf","melon","carrot","sprig_of_wolfsbane","clove_of_garlic","slime_mold","cream_pie","candy_bar","fortune_cookie","pancake","lembas_wafer","cram_ration","food_ration","k_ration","c_ration","tin","sky_blue","purple_red","puce","milky","swirly","bubbly","smoky","cloudy","effervescent","golden","fizzy","murky","zelgo_mer","juyed_awk_yacc","nr_9","xixaxa_xoxaxa_xuxaxa","pratyavayah","daiyen_fooels","lep_gex_ven_zea","prirutsenie","elbib_yloh","verr_yed_horre","venzar_borgavve","tharr","yum_yum","elam_ebow","duam_xnaht","andova_begarin","kirje","ve_forbryderne","hackem_muche","velox_neb","foobie_bletch","temov","garven_deh","read_me","mail","vellum","ragged","dog_eared","mottled","stained","velvet","indigo","violet","gray","wrinkled","dusty","shining","dull","thin","thick","balsa","crystal","maple","pine","oak","ebony","marble","platinum","iridium","zinc","aluminum","uranium","short","runed","long","curved","forked","spiked","jeweled","blue","green","yellowish_brown","grey_stone","boulder","statue","heavy_iron_ball","iron_chain","blank","dark_part_of_a_room","dngn_rock_wall_00","dngn_rock_wall_01","dngn_rock_wall_02","dngn_rock_wall_03","dngn_rock_wall_04","dngn_rock_wall_05","dngn_rock_wall_06","dngn_rock_wall_07","dngn_rock_wall_08","dngn_rock_wall_09","dngn_rock_wall_10","dngn_rock_wall_11","dngn_rock_wall_12","dngn_rock_wall_13","dngn_rock_wall_14","dngn_rock_wall_15","dngn_stone_wall","dngn_closed_door","dngn_metal_wall","dngn_green_crystal_wall","dngn_orcish_idol","dngn_wax_wall","dngn_silver_statue","dngn_granite_statue","dngn_orange_crystal_statue","dngn_lava","dngn_deep_water","dngn_shallow_water","floor_of_a_room","dngn_enter_hell","dngn_open_door","staircase_down","dngn_trap_mechanical","dngn_trap_magical","dngn_trap_iii","dngn_enter_shop","dngn_enter_labyrinth","staircase_up","dngn_enter_dis","dngn_enter_gehenna","dngn_enter_cocytus","dngn_enter_tartarus","dngn_enter_abyss","dngn_exit","dngn_stone_arch","dngn_enter_pandemonium","dngn_transit_pandemonium","dngn_enter","dngn_return","dngn_altar_zin","dngn_altar_shining_one","dngn_altar_kikubaaqudgha","dngn_altar_yredelemnul","dngn_altar_xom","dngn_altar_vehumet","dngn_altar_okawaru","dngn_altar_makhleb","dngn_altar_sif_muna","dngn_altar_trog","dngn_altar_nemelex_xobeh","dngn_altar_elyvilon","dngn_blue_fountain","dngn_dry_fountain","dngn_sparkling_fountain","blinding_venom","acid_venom","wall_main00","wall_main01","wall_main02","wall_main03","wall_main04","wall_main05","wall_main06","wall_main07","wall_main08","wall_main09","wall_main10","doorway","open_door_h","open_door_v","closed_door_h","closed_door_v","iron_bars","tree","corridor","lit_corridor","ladder_up","ladder_down","altar","grave","opulent_throne","sink","fountain","water","ice","molten_lava","lowered_drawbridge_v","lowered_drawbridge_h","raised_drawbridge_v","raised_drawbridge_h","air","cloud","arrow_trap","dart_trap","falling_rock_trap","squeaky_board","bear_trap","rolling_boulder_trap","sleeping_gas_trap","rust_trap","fire_trap","pit","spiked_pit","hole","trap_door","teleportation_trap","level_teleporter","magic_portal","web","statue_trap","magic_trap","anti_magic_trap_field","polymorph_trap","zigzag1","zigzag2","zigzag3","zigzag4","zap_dig","zap_flash","boomerang1","boomerang2","resist1","resist2","resist3","resist4","engulf1","engulf2","engulf3","engulf4","engulf5","engulf6","engulf7","engulf8","explode_black0","explode_black1","explode_black2","explode_black3","explode_black4","explode_black5","explode_black6","explode_black7","explode_black8","explode_green0","explode_green1","explode_green2","explode_green3","explode_green4","explode_green5","explode_green6","explode_green7","explode_green8","explode_brown0","explode_brown1","explode_brown2","explode_brown3","explode_brown4","explode_brown5","explode_brown6","explode_brown7","explode_brown8","explode_blue0","explode_blue1","explode_blue2","explode_blue3","explode_blue4","explode_blue5","explode_blue6","explode_blue7","explode_blue8","explode_purple0","explode_purple1","explode_purple2","explode_purple3","explode_purple4","explode_purple5","explode_purple6","explode_purple7","explode_purple8","explode_red0","explode_red1","explode_red2","explode_red3","explode_red4","explode_red5","explode_red6","explode_red7","explode_red8","explode_darkblue0","explode_darkblue1","explode_darkblue2","explode_darkblue3","explode_darkblue4","explode_darkblue5","explode_darkblue6","explode_darkblue7","explode_darkblue8","zap_magic0","zap_magic1","zap_magic2","zap_magic3","zap_fire0","zap_fire1","zap_fire2","zap_fire3","zap_ice0","zap_ice1","zap_ice2","zap_ice3","zap_sleep0","zap_sleep1","zap_sleep2","zap_sleep3","zap_black0","zap_black1","zap_black2","zap_black3","zap_elec0","zap_elec1","zap_elec2","zap_elec3","zap_gas0","zap_gas1","zap_gas2","zap_gas3","zap_acid0","zap_acid1","zap_acid2","zap_acid3","question1","question2","question3","question4","question5","question6","wall_mine00","wall_mine01","wall_mine02","wall_mine03","wall_mine04","wall_mine05","wall_mine06","wall_mine07","wall_mine08","wall_mine09","wall_mine10","wall_gehennom00","wall_gehennom01","wall_gehennom02","wall_gehennom03","wall_gehennom04","wall_gehennom05","wall_gehennom06","wall_gehennom07","wall_gehennom08","wall_gehennom09","wall_gehennom10","wall_knox00","wall_knox01","wall_knox02","wall_knox03","wall_knox04","wall_knox05","wall_knox06","wall_knox07","wall_knox08","wall_knox09","wall_knox10","wall_sokoban00","wall_sokoban01","wall_sokoban02","wall_sokoban03","wall_sokoban04","wall_sokoban05","wall_sokoban06","wall_sokoban07","wall_sokoban08","wall_sokoban09","wall_sokoban10"]}'),P=n.p+"edfde9e464f7661e223c.png";class H{constructor(){}static create2dArray(e){const t=[];for(let n=0;n<e;n++)t[n]=[];return t}}class j{constructor(e={},t,n){this.rawArgs=e,this.args=[],this.baseType=t||"component",this.type=n||this.baseType,this.parentEntity=e.parentEntity,this.cachedSave=null}clearSaveCache(){this.cachedSave=null,this.parentEntity?.clearSaveCache()}save(){if(this.cachedSave)return this.cachedSave;const e={};e[this.type]={};for(const t of this.args)t.save(e,this.type);return this.cachedSave=e,e}hasComponent(){return this.rawArgs.components&&void 0!==this.rawArgs.components[this.type]}getComponent(){return this.rawArgs.components[this.type]}addArg(e){return e.setParentComponent(this),this.args.push(e),this.hasComponent()&&e.load(this.getComponent()),e}}class U{#e;_name;_defaultValue;_value;constructor(e,t){this._name=e,this._defaultValue=t}setParentComponent(e){this.#e=e}getParentComponent(){return this.#e}save(e,t){return this._value!==this._defaultValue&&(e[t][this._name]=this._value),e}load(e){this._value=e[this._name]??this._defaultValue}get(){return this._value}set(e){this._value=e,this.#e.clearSaveCache()}}class R extends j{constructor(e){super(e,"fov"),this.explored=this.addArg(new U("explored",!1)),this.visible=this.addArg(new U("visible",!1))}isExplored(){return this.explored.get()}setExplored(e){this.explored.set(e)}isVisible(){return this.visible.get()}setVisible(e){this.visible.set(e)}}class G{constructor(){this.previousVisibleTiles=[],this.visibleTiles=[],this.visibleActors=[],this.visibleItems=[],this.left=0,this.right=0,this.top=0,this.bottom=0}teardown(){this.previousVisibleTiles=[],this.visibleTiles=[],this.visibleActors=[],this.visibleItems=[]}compute(e,t,n,s){this.previousVisibleTiles=this.visibleTiles,this.visibleTiles=[],this.visibleActors=[],this.visibleItems=[],this.left=Math.max(0,t-s),this.right=Math.min(e.width,t+s+1),this.top=Math.max(0,n-s),this.bottom=Math.min(e.height,n+s+1)}addVisibleTile(e){-1===this.visibleTiles.indexOf(e)&&this.visibleTiles.push(e)}addVisibleActor(e){-1===this.visibleActors.indexOf(e)&&this.visibleActors.push(e)}addVisibleItem(e){-1===this.visibleItems.indexOf(e)&&this.visibleItems.push(e)}exploreTile(e,t,n){const s=e.tiles[t];if(s){const e=s[n];e&&this.addVisibleTile(e)}for(const s of e.actors){const e=s.getComponent("position");e&&e.isAt(t,n)&&this.addVisibleActor(s)}for(const s of e.items){const e=s.getComponent("position");e&&e.isAt(t,n)&&this.addVisibleItem(s)}}updateMap(){for(const e of this.previousVisibleTiles)e.getComponent("fov")?.setVisible(!1);for(const e of this.visibleTiles){const t=e.getComponent("fov");t?(t.setExplored(!0),t.setVisible(!0)):e.setComponent(new R({components:{fov:{explored:!0,visible:!0}}}))}}}class W{constructor(e,t){this.y=e,this.x=t}greater(e,t){return this.y*t>this.x*e}greaterOrEqual(e,t){return this.y*t>=this.x*e}lessOrEqual(e,t){return this.y*t<=this.x*e}}class Y extends G{constructor(){super()}compute(e,t,n,s){super.compute(e,t,n,s),this.exploreTile(e,t,n);for(let o=0;o<8;o++)this.computeOctant(e,o,t,n,s,1,new W(1,1),new W(0,1))}computeOctant(e,t,n,s,o,i,a,r){for(;i<=o;i++){let l,c;if(1===a.x)l=i;else if(l=Math.round(((2*i-1)*a.y+a.x)/(2*a.x)),this.blocksLight(e,t,n,s,i,l))a.greaterOrEqual(2*l+1,2*i)&&!this.blocksLight(e,t,n,s,i,l+1)&&l++;else{let o=2*i;this.blocksLight(e,t,n,s,i+1,l+1)&&o++,a.greater(2*l+1,o)&&l++}0===r.y?c=0:(c=((2*i-1)*r.y+r.x)/(2*r.x),r.greaterOrEqual(2*c+1,2*i)&&this.blocksLight(e,t,n,s,i,c)&&!this.blocksLight(e,t,n,s,i,c+1)&&c++);let h=-1;for(let d=l;d>=c;d--){const p=this.blocksLight(e,t,n,s,i,d);if((p||(d!==l||a.greaterOrEqual(d,i))&&(d!==c||r.lessOrEqual(d,i)))&&this.setVisible(e,t,n,s,i,d),i!==o)if(p){if(0===h){const l=2*i,h=2*d+1;if(a.greater(h,l)){if(d===c){r=new W(h,l);break}this.computeOctant(e,t,n,s,o,i+1,a,new W(h,l))}else if(d===c)return}h=1}else{if(h>0){const e=2*i,t=2*d+1;if(r.greaterOrEqual(t,e))return;a=new W(t,e)}h=0}}if(0!==h)break}}blocksLight(e,t,n,s,o,i){switch(t){case 0:n+=o,s-=i;break;case 1:n+=i,s-=o;break;case 2:n-=i,s-=o;break;case 3:n-=o,s-=i;break;case 4:n-=o,s+=i;break;case 5:n-=i,s+=o;break;case 6:n+=i,s+=o;break;case 7:n+=o,s+=i}let a=!1;const r=e.tiles;if(r[n]){const e=r[n][s];if(e){const t=e.getComponent("blocksFov");t&&(a=t.blocksFov.get())}}return a}setVisible(e,t,n,s,o,i){switch(t){case 0:n+=o,s-=i;break;case 1:n+=i,s-=o;break;case 2:n-=i,s-=o;break;case 3:n-=o,s-=i;break;case 4:n-=o,s+=i;break;case 5:n-=i,s+=o;break;case 6:n+=i,s+=o;break;case 7:n+=o,s+=i}this.exploreTile(e,n,s)}}class J{constructor(){}static extend(e){e=e||{};for(let t=1;t<arguments.length;t++)if(arguments[t])for(const n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}static deep(e){e=e||{};for(let t=1;t<arguments.length;t++){const n=arguments[t];if(n)for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&("object"==typeof n[t]?n[t]instanceof Array?e[t]=n[t].slice(0):e[t]=J.deep(e[t],n[t]):"boolean"==typeof e&&void 0===e[t]?e=n[t]:e[t]=n[t])}return e}}class V extends j{constructor(e={},t){super(e,"ai",t)}save(){return super.save()}perform(e){console.error("Not Implemented")}}class X extends V{constructor(e={}){super(e,"aiDead"),this.previousAI=this.addArg(new U("previousAI",""))}}const Z=new class extends w{constructor(){super('<div class="ui hero-info">\n    <div class="hero-status">\n        <div class="hero-status__message"></div>\n    </div>\n    <div class="hero-health">\n        <div class="hero-health__fg"></div>\n        <div class="hero-health__text"></div>\n    </div>\n    <div class="hero-stats">\n        <div class="hero-stat">Power: <span class="hero-power"></span></div>\n        <div class="hero-stat">Defense: <span class="hero-defense"></span></div>\n    </div>\n    <div class="hero-inventory"></div>\n</div>'),this.statusMessageDom=this.dom.getElementsByClassName("hero-status__message")[0],this.healthFgDom=this.dom.getElementsByClassName("hero-health__fg")[0],this.healthTextDom=this.dom.getElementsByClassName("hero-health__text")[0],this.powerDom=this.dom.getElementsByClassName("hero-power")[0],this.defenseDom=this.dom.getElementsByClassName("hero-defense")[0],this.inventoryDom=this.dom.getElementsByClassName("hero-inventory")[0]}updateStatus(e){this.statusMessageDom.innerText=e}updateHealth(e,t){const n=e/t*100;this.healthFgDom.style.width=n+"%",this.healthTextDom.innerText="HP: "+e+" / "+t}updatePower(e){this.powerDom.innerText=e}updateDefense(e){this.defenseDom.innerText=e}updateInventory(){}};class K extends j{constructor(e={}){super(e,"position"),this.x=this.addArg(new U("x",0)),this.y=this.addArg(new U("y",0))}moveTo(e,t){this.x.set(e),this.y.set(t)}move(e,t){this.x.set(this.x.get()+e),this.y.set(this.y.get()+t)}distanceTo(e){const t=Math.abs(e.x.get()-this.x.get()),n=Math.abs(e.y.get()-this.y.get());return Math.max(t,n)}isAt(e,t){return this.x.get()===e&&this.y.get()===t}isEqual(e){return this.x.get()===e.x.get()&&this.y.get()===e.y.get()}}class Q{constructor(){}static randomInt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}static randomNumber(e,t){return Math.random()*(t-e)+e}}class $ extends f{constructor(e,t=0,n=0){super(e),this.dx=t,this.dy=n}perform(){console.error("Not Implemented")}}class ee extends ${constructor(e,t=0,n=0){super(e,t,n)}perform(e){const t=this.entity.getComponent("position");if(!t)return new b(this.entity,"Entity doesn't have a position.");const n=t.x.get()+this.dx,s=t.y.get()+this.dy,o=e.getBlockingActorAtLocation(n,s);if(!o)return new b(this.entity,"There's nothing to attack there!");{const e=this.entity.getComponent("fighter"),t=o.getComponent("fighter");if(e&&t){let n,s,i,a;Ht.isPlayer(this.entity)?(n="You",s=""):(n=this.entity.name,s="s"),o===Ht.player?(i="You",a="#C00"):(i=o.name,a="#999");const r=n+" attack"+s+" "+i,l=e.getDamage()-t.getBlockedDamage();l>0?(C.text(r+" for "+l+" hit points.",a).build(),t.takeDamage(l)):C.text(r+", but does no damage.",a).build(),this.entity.callEvent("onMeleeAttack",o)}}}}class te extends ${constructor(e,t=0,n=0){super(e,t,n)}perform(e){const t=this.entity.getComponent("position");if(!t)return new b(this.entity,"Entity doesn't have a position.");const n=t.x.get()+this.dx,s=t.y.get()+this.dy;if(!e.isInBounds(n,s))return new b(this.entity,"Location is outside the map!");const o=this.tryMoveTo(e,n,s);return o instanceof b||t.move(this.dx,this.dy),o}tryMoveTo(e,t,n){if(e.getBlockingActorAtLocation(t,n))return new b(this.entity,"There's something in the way!");const s=e.tiles[t][n];return s&&s.getComponent("blocksMovement")?.blocksMovement.get()?new b(this.entity,"There's a "+s.name+" in the way!"):this}}class ne extends f{constructor(e){super(e)}perform(){return this}}class se extends f{constructor(e){super(e)}perform(e){const t=Q.randomInt(-1,1),n=Q.randomInt(-1,1);return 0===t&&0===n?new ne(this.entity).perform(e):new te(this.entity,t,n).perform(e)}}class oe{constructor(e){this.content=[],this.scoreFunction=e}push(e){this.content.push(e),this.sinkDown(this.content.length-1)}pop(){const e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e}remove(e){const t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))}size(){return this.content.length}rescoreElement(e){this.sinkDown(this.content.indexOf(e))}sinkDown(e){const t=this.content[e];for(;e>0;){const n=(e+1>>1)-1,s=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(s)))break;this.content[n]=t,this.content[e]=s,e=n}}bubbleUp(e){const t=this.content.length,n=this.content[e],s=this.scoreFunction(n);let o=!1;for(;!o;){const i=e+1<<1,a=i-1;let r,l=null;if(a<t){const e=this.content[a];r=this.scoreFunction(e),r<s&&(l=a)}if(i<t){const e=this.content[i];this.scoreFunction(e)<(null===l?s:r)&&(l=i)}if(null===l){o=!0;break}this.content[e]=this.content[l],this.content[l]=n,e=l}}}class ie{constructor(){}static pathTo(e){let t=e;const n=[];for(;t.parent;)n.unshift(t),t=t.parent;return n}static getHeap(){return new oe((function(e){return e.f}))}static search(e,t,n,s){e.cleanDirty(),s=s||{},this.heuristicType=s.heuristic||"manhattan";const o=s.closest||!1,i=this.getHeap();let a=t;for("manhattan"===this.heuristicType?t.h=this.heuristicManhattan(t,n):"diagonal"===this.heuristicType&&this.heuristicDiagonal(t,n),e.markDirty(t),i.push(t);i.size()>0;){const t=i.pop();if(t===n)return this.pathTo(t);t.closed=!0;const s=e.neighbors(t);for(let r=0,l=s.length;r<l;++r){const l=s[r];if(l.closed||l.isWall())continue;const c=t.g+l.getCost(t),h=l.visited;(!h||c<l.g)&&(l.visited=!0,l.parent=t,"manhattan"===this.heuristicType?l.h=l.h||this.heuristicManhattan(l,n):"diagonal"===this.heuristicType&&(l.h=l.h||this.heuristicDiagonal(l,n)),l.g=c,l.f=l.g+l.h,e.markDirty(l),o&&(l.h<a.h||l.h===a.h&&l.g<a.g)&&(a=l),h?i.rescoreElement(l):i.push(l))}}return o?this.pathTo(a):[]}static heuristicManhattan(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}static heuristicDiagonal(e,t){const n=Math.sqrt(2),s=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y);return 1*(s+o)+(n-2)*Math.min(s,o)}static cleanNode(e){e.f=0,e.g=0,e.h=0,e.visited=!1,e.closed=!1,e.parent=null}}class ae{constructor(e,t,n){this.x=e,this.y=t,this.weight=n}toString(){return"["+this.x+" "+this.y+"]"}getCost(e){return e&&e.x!==this.x&&e.y!==this.y?1.41421*this.weight:this.weight}isWall(){return 0===this.weight}}class re{constructor(e,t){t=t||{},this.nodes=[],this.diagonal=!!t.diagonal,this.grid=[];for(let t=0;t<e.length;t++){this.grid[t]=[];for(let n=0,s=e[t];n<s.length;n++){const e=new ae(t,n,s[n]);this.grid[t][n]=e,this.nodes.push(e)}}this.init()}init(){this.dirtyNodes=[];for(let e=0;e<this.nodes.length;e++)ie.cleanNode(this.nodes[e])}cleanDirty(){for(let e=0;e<this.dirtyNodes.length;e++)ie.cleanNode(this.dirtyNodes[e]);this.dirtyNodes=[]}markDirty(e){this.dirtyNodes.push(e)}neighbors(e){const t=[],n=e.x,s=e.y,o=this.grid;return o[n-1]&&o[n-1][s]&&t.push(o[n-1][s]),o[n+1]&&o[n+1][s]&&t.push(o[n+1][s]),o[n]&&o[n][s-1]&&t.push(o[n][s-1]),o[n]&&o[n][s+1]&&t.push(o[n][s+1]),this.diagonal&&(o[n-1]&&o[n-1][s-1]&&t.push(o[n-1][s-1]),o[n+1]&&o[n+1][s-1]&&t.push(o[n+1][s-1]),o[n-1]&&o[n-1][s+1]&&t.push(o[n-1][s+1]),o[n+1]&&o[n+1][s+1]&&t.push(o[n+1][s+1])),t}toString(){const e=[],t=this.grid;for(let n=0;n<t.length;n++){const s=[],o=t[n];for(let e=0;e<o.length;e++)s.push(o[e].weight);e.push(s.join(" "))}return e.join("\n")}}class le extends ${constructor(e,t=0,n=0){super(e,t,n)}perform(e){const t=this.entity.getComponent("position");if(!t)return new b(this.entity,"Entity doesn't have a position.");const n=t.x.get()+this.dx,s=t.y.get()+this.dy,o=e.getCleanableActorAtLocation(n,s);if(!o)return new b(this.entity,"There's nothing to clean there!");{const t=o.getComponent("cleanable");if(t){const n=t.decreasesTo.get();if(n){const t=o.getComponent("position"),s=It.createFromTemplate(n,{components:{position:{x:t.x.get(),y:t.y.get()}}});e.addActor(s)}e.removeActor(o)}}}}class ce extends ${constructor(e,t=0,n=0){super(e,t,n)}perform(e){const t=this.entity.getComponent("position");if(!t)return new b(this.entity,"Entity doesn't have a position.");const n=t.x.get()+this.dx,s=t.y.get()+this.dy,o=e.tiles[n][s];if(o){const e=o.getComponent("interactable");if(e)return e.interact(this.entity),new v(this.entity)}return new b(this.entity,"There is nothing to interact with here.")}}class he extends ${constructor(e,t=0,n=0){super(e,t,n)}perform(e){const t=this.entity.getComponent("position");if(!t)return new b(this.entity,"Entity doesn't have a position.");const n=t.x.get()+this.dx,s=t.y.get()+this.dy;if(e.getBlockingActorAtLocation(n,s))return new ee(this.entity,this.dx,this.dy).perform(e);if(e.getCleanableActorAtLocation(n,s))return new le(this.entity,this.dx,this.dy).perform(e);const o=e.tiles[n];if(o){const t=o[s];if(t){const n=t.getComponent("interactable");if(n&&"stairsInteractable"!==n.type&&"trapDoorInteractable"!==n.type)return new ce(this.entity,this.dx,this.dy).perform(e)}return new te(this.entity,this.dx,this.dy).perform(e)}return new b(this.entity,"Nowhere to move.")}}class de extends f{constructor(e){super(e)}perform(e){const t=this.entity.getComponent("position");if(!t)return new b(this.entity,"Entity doesn't have a position.");const n=e.tiles[t.x.get()][t.y.get()];if(n){const e=n.getComponent("interactable");if(e)return e.interact(this.entity),new v(this.entity)}return new b(this.entity,"There is nothing to interact with here.")}}class pe extends V{constructor(e={}){super(e,"aiHero"),this.fov=new Y,this.chaseLocation=null,this.radius=this.addArg(new U("radius",10)),this.movementActions=this.addArg(new U("movementActions",1)),this.currentMovement=this.addArg(new U("currentMovement",0)),this.turnsToEnterDungeon=this.addArg(new U("turnsToEnterDungeon",30)),this.status=this.addArg(new U("status","Hero will arrive in "+this.turnsToEnterDungeon.get()+" turns.")),this.updateUIStatus()}decreaseTurnsToEnterDungeon(){this.turnsToEnterDungeon.set(this.turnsToEnterDungeon.get()-1)}setStatus(e){this.status.set(e),this.updateUIStatus()}updateUIStatus(){Z.updateStatus(this.status.get())}perform(e){const t=this.parentEntity;if(this.turnsToEnterDungeon.get()>0)this.decreaseTurnsToEnterDungeon(),this.setStatus("Hero will arrive in "+this.turnsToEnterDungeon.get()+" turns.");else if(0===this.turnsToEnterDungeon.get())t.setComponent(new K({components:{position:{x:5,y:0}}})),this.decreaseTurnsToEnterDungeon(),this.setStatus("Hero has entered the dungeon!");else{const n=t.getComponent("position");if(n){this.fov.compute(e,n.x.get(),n.y.get(),this.radius.get());const s=this.getClosestEnemy();if(s){const o=s.getComponent("position");if(this.chaseLocation={x:o.x.get(),y:o.y.get()},n.distanceTo(o)<=1)return this.setStatus("Hero is fighting "+s.name+"!"),new ee(t,o.x.get()-n.x.get(),o.y.get()-n.y.get()).perform(e);this.setStatus("Hero is moving to attack "+s.name+".")}else{const s=this.getClosestStairs();if(s){const o=s.getComponent("position");if(this.chaseLocation={x:o.x.get(),y:o.y.get()},n.distanceTo(o)<=0)return this.setStatus("Hero is climbing down the stairs!"),new de(t).perform(e);this.setStatus("Hero is moving towards the stairs!")}if(null!==this.chaseLocation&&n.isAt(this.chaseLocation.x,this.chaseLocation.y)&&(this.chaseLocation=null),null===this.chaseLocation)return this.setStatus("Hero is wandering aimlessly."),new se(t).perform(e)}return this.moveTowards(e)}}}getClosestEnemy(){const e=this.parentEntity,t=e.getComponent("position");let n=[],s=null;const o=e.getComponent("faction");if(o)for(const e of this.fov.visibleActors)if(e.isAlive()){const i=e.getComponent("faction");if(o.isEnemyOf(i)){const o=e.getComponent("position");if(o){const i=t.distanceTo(o);null===s||i<s?(n=[],n.push(e),s=i):i===s&&n.push(e)}}}return 1===n.length?n[0]:n.length>1?n[Q.randomInt(0,n.length-1)]:null}getClosestStairs(){const e=this.parentEntity.getComponent("position");let t=[],n=null;for(const s of this.fov.visibleTiles){const o=s.getComponent("interactable");if(o&&"stairsInteractable"===o.type){const o=s.getComponent("position");if(o){const i=e.distanceTo(o);null===n||i<n?(t=[],t.push(s),n=i):i===n&&t.push(s)}}}return 1===t.length?t[0]:t.length>1?t[Q.randomInt(0,t.length-1)]:null}moveTowards(e){const t=this.parentEntity,n=t.getComponent("position");if(this.currentMovement.set(this.movementActions.get()),this.currentMovement.get()>=1){const s=this.fov.right-this.fov.left,o=this.fov.bottom-this.fov.top,i=Array(s).fill().map((()=>Array(o).fill(0)));for(let t=this.fov.left;t<this.fov.right;t++)for(let n=this.fov.top;n<this.fov.bottom;n++){const s=e.tiles[t][n];if(s){if(s.getComponent("blocksMovement")?.blocksMovement.get())continue;i[t-this.fov.left][n-this.fov.top]+=10}}for(const e of this.fov.visibleActors)if(e.isAlive()){const t=e.getComponent("position");t&&(i[t.x.get()-this.fov.left][t.y.get()-this.fov.top]+=100)}const a=new re(i,{diagonal:!0}),r=a.grid[n.x.get()-this.fov.left][n.y.get()-this.fov.top],l=a.grid[this.chaseLocation.x-this.fov.left][this.chaseLocation.y-this.fov.top],c=ie.search(a,r,l);let h;for(;this.currentMovement.get()>=1;){if(c&&c.length>0){const s=c.shift();s&&(h=new he(t,s.x+this.fov.left-n.x.get(),s.y+this.fov.top-n.y.get()).perform(e))}else h=new ne(t).perform(e);this.currentMovement.set(this.currentMovement.get()-1)}return h}}}class me extends V{constructor(e={}){super(e,"aiMeleeChase"),this.fov=new Y,this.chaseLocation=null,this.radius=this.addArg(new U("radius",5)),this.movementActions=this.addArg(new U("movementActions",1)),this.currentMovement=this.addArg(new U("currentMovement",0))}perform(e){const t=this.parentEntity,n=t.getComponent("position");if(n){this.fov.compute(e,n.x.get(),n.y.get(),this.radius.get());let s=[],o=null;const i=t.getComponent("faction");if(i)for(const e of this.fov.visibleActors)if(e.isAlive()){const t=e.getComponent("faction");if(i.isEnemyOf(t)){const t=e.getComponent("position");if(t){const i=t.distanceTo(n);null===o||i<o?(s=[],s.push(e),o=i):i===o&&s.push(e)}}}let a;if(1===s.length?a=s[0]:s.length>1&&(a=s[Q.randomInt(0,s.length-1)]),a){const s=a.getComponent("position");if(this.chaseLocation={x:s.x.get(),y:s.y.get()},o<=1)return new ee(t,s.x.get()-n.x.get(),s.y.get()-n.y.get()).perform(e)}else if(null!==this.chaseLocation&&n.isAt(this.chaseLocation.x,this.chaseLocation.y)&&(this.chaseLocation=null),null===this.chaseLocation)return new se(t).perform(e);if(this.currentMovement.set(this.currentMovement.get()+this.movementActions.get()),this.currentMovement.get()>=1){const s=this.fov.right-this.fov.left,o=this.fov.bottom-this.fov.top,i=Array(s).fill().map((()=>Array(o).fill(0)));for(let t=this.fov.left;t<this.fov.right;t++)for(let n=this.fov.top;n<this.fov.bottom;n++){const s=e.tiles[t][n];if(s){if(s.getComponent("blocksMovement")?.blocksMovement.get())continue;i[t-this.fov.left][n-this.fov.top]+=10}}for(const e of this.fov.visibleActors)if(e.isAlive()){const t=e.getComponent("position");t&&(i[t.x.get()-this.fov.left][t.y.get()-this.fov.top]+=100)}const a=new re(i,{diagonal:!0}),r=a.grid[n.x.get()-this.fov.left][n.y.get()-this.fov.top],l=a.grid[this.chaseLocation.x-this.fov.left][this.chaseLocation.y-this.fov.top],c=ie.search(a,r,l);let h;for(;this.currentMovement.get()>=1;){if(c&&c.length>0){const s=c.shift();s&&(h=new he(t,s.x+this.fov.left-n.x,s.y+this.fov.top-n.y).perform(e))}else h=new ne(t).perform(e);this.currentMovement.set(this.currentMovement.get()-1)}return h}}}}class ue extends j{constructor(e={},t){super(e,"interactable",t)}save(){return super.save()}interact(e){}}class _e{constructor(){this.mouse={x:-1,y:-1},this.mouseDown=!1,window.addEventListener("mousemove",this),window.addEventListener("mousedown",this),window.addEventListener("mouseup",this),window.addEventListener("click",this),window.addEventListener("contextmenu",this),window.addEventListener("change",this),window.addEventListener("keydown",this),this.isPlayerTurn=!0,this.targetedTile=null,this.pathTiles=[]}teardown(){window.removeEventListener("mousemove",this),window.removeEventListener("mousedown",this),window.removeEventListener("mouseup",this),window.removeEventListener("click",this),window.removeEventListener("contextmenu",this),window.removeEventListener("change",this),window.removeEventListener("keydown",this)}handleEvent(e){switch(e.type){case"mousemove":this.onMouseMove(e);break;case"mousedown":this.onMouseDown(e);break;case"mouseup":this.onMouseUp(e);break;case"click":this.onLeftClick(e);break;case"contextmenu":this.onRightClick(e);break;case"change":this.onChange(e);break;case"keydown":this.onKeydown(e)}}handleInput(){}onMouseMove(){}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onLeftClick(){}onRightClick(){}onChange(){}onKeydown(){}}const ge="ArrowLeft",fe="ArrowRight",ve="ArrowUp",be="ArrowDown",ye="Enter",Ae="Left Shift",we="Right Shift",xe="Escape",ke="Numpad Enter",Ce="Numpad .",Ie="Numpad 0",Me="Numpad 1",Be="Numpad 2",Ee="Numpad 3",Te="Numpad 4",Se="Numpad 5",De="Numpad 6",ze="Numpad 7",Le="Numpad 8",Ne="Numpad 9",Fe="Numpad Delete",Oe="Numpad Insert",qe="Numpad End",Pe="Numpad ArrowDown",He="Numpad PageDown",je="Numpad ArrowLeft",Ue="Numpad Clear",Re="Numpad ArrowRight",Ge="Numpad Home",We="Numpad ArrowUp",Ye="Numpad PageUp",Je=new class{constructor(){const e=this;e.defaultDelay=25,e.lastShiftUp=null,e.treatShiftNumpadEqual=!0,e.keysDown=[],e.keysDelayed=[],e.defaults=new Map,e.controls=new Map,e.defaults.set("up",[Le,ve]),e.defaults.set("down",[Be,be]),e.defaults.set("left",[Te,ge]),e.defaults.set("right",[De,fe]),e.defaults.set("nw",[ze]),e.defaults.set("ne",[Ne]),e.defaults.set("sw",[Me]),e.defaults.set("se",[Ee]),e.defaults.set("wait",[Se]),e.defaults.set("escape",[xe]),e.defaults.set("confirm",[ye,ke]),e.load(),addEventListener("keydown",(function(t){"/"===t.key&&t.preventDefault(),e.treatShiftNumpadEqual&&t.getModifierState("NumLock")&&!t.shiftKey&&t.code.startsWith("Numpad")&&t.keyCode<90&&e.lastShiftUp&&(e.keysDown[e.lastShiftUp]=!0);const n=e.getKey(t.key,t.code);e.keysDown[n]=!0}),!1),addEventListener("keyup",(function(t){const n=e.getKey(t.key,t.code);n!==Ae&&n!==we||(e.lastShiftUp=n),delete e.keysDown[n],delete e.keysDelayed[n]}),!1)}getKey(e,t){if(t.startsWith("Arrow")||(t.endsWith("Left")?e="Left "+e:t.endsWith("Right")?e="Right "+e:t.startsWith("Numpad")&&(e="Numpad "+e)),this.treatShiftNumpadEqual)switch(e){case Fe:e=Ce;break;case Oe:e=Ie;break;case qe:e=Me;break;case Pe:e=Be;break;case He:e=Ee;break;case je:e=Te;break;case Ue:e=Se;break;case Re:e=De;break;case Ge:e=ze;break;case We:e=Le;break;case Ye:e=Ne}return e}load(){const e=localStorage.getItem("controls");e?this.controls=new Map(JSON.parse(e)):this.resetToDefault()}save(){localStorage.setItem("controls",JSON.stringify(Array.from(this.controls.entries())))}setControls(e){this.controls=new Map;for(const[t,n]of e.entries()){const e=[];for(const t of n)e.push(t);this.controls.set(t,e)}this.save()}resetToDefault(){this.setControls(this.defaults)}clone(){const e=new Map;for(const[t,n]of this.controls.entries()){const s=[];for(const e of n)s.push(e);e.set(t,s)}return e}isPressed(e){const t=this;let n=!1,s=t.controls.get(e);if(!s){const n=t.defaults.get(e);n?(t.controls.set(e,n),t.save(),s=n):console.error("Missing keybindings for: ",e,s)}return s.forEach((function(e){e in t.keysDown&&(n=!0)})),n}isDelayed(e){const t=this;let n=!1;return this.controls.get(e).forEach((function(e){e in t.keysDelayed&&(n=!0)})),n}deleteKey(e,t){const n=this;n.controls.get(e).forEach((function(e){delete n.keysDown[e],t&&(n.keysDelayed[e]=!0)})),t&&setTimeout((function(){n.controls.get(e).forEach((function(e){delete n.keysDelayed[e]}))}),t)}testPressed(e,t){t=t||this.defaultDelay;const n=this;let s=!1;return n.isPressed(e)&&!n.isDelayed(e)&&(n.deleteKey(e,t),s=!0),s}};class Ve extends _e{constructor(e){super(),this.previousHandler=e}handleInput(){return Je.testPressed("escape")&&this.exit(),null}onLeftClick(){this.exit()}exit(){Ht.eventHandler=this.previousHandler}}const Xe=new class extends w{constructor(){super('<div class="ui trade-list">\n    <h1 class="trade-list__title"></h1>\n    <div class="trade-list__wrap">\n        <div class="trade-list__left">\n            <ol class="trade-list__left-options"></ol>\n        </div>\n        <div class="trade-list__right">\n            <ol class="trade-list__right-options"></ol>\n        </div>\n    </div>\n</div>'),this.titleDom=this.dom.getElementsByClassName("trade-list__title")[0],this.leftOptionsDom=this.dom.getElementsByClassName("trade-list__left-options")[0],this.rightOptionsDom=this.dom.getElementsByClassName("trade-list__right-options")[0]}setTitle(e){this.titleDom.innerText=e}setOptions(e,t){this.leftOptionsDom.innerHTML="";let n=0;for(const t of e){const e=document.createElement("li");e.classList.add("trade-list__option"),e.dataset.index=n.toString(),0===n&&e.classList.add("active"),e.innerText=t?t.name:"<empty>",this.leftOptionsDom.appendChild(e),n++}this.rightOptionsDom.innerHTML="",n=0;for(const e of t){const t=document.createElement("li");t.classList.add("trade-list__option"),t.dataset.index=n.toString(),t.innerText=e?e.name:"<empty>",this.rightOptionsDom.appendChild(t),n++}}moveActiveUp(){let e=this.leftOptionsDom.getElementsByClassName("active")[0];if(e){const t=e.previousElementSibling;if(t)t!==e&&(t.classList.add("active"),e.classList.remove("active"));else{const t=this.leftOptionsDom.lastElementChild;t!==e&&(t.classList.add("active"),e.classList.remove("active"))}}else if(e=this.rightOptionsDom.getElementsByClassName("active")[0],e){const t=e.previousElementSibling;if(t)t!==e&&(t.classList.add("active"),e.classList.remove("active"));else{const t=this.rightOptionsDom.lastElementChild;t!==e&&(t.classList.add("active"),e.classList.remove("active"))}}}moveActiveDown(){let e=this.leftOptionsDom.getElementsByClassName("active")[0];if(e){const t=e.nextElementSibling;if(t)t!==e&&(t.classList.add("active"),e.classList.remove("active"));else{const t=this.leftOptionsDom.firstElementChild;t!==e&&(t.classList.add("active"),e.classList.remove("active"))}}else if(e=this.rightOptionsDom.getElementsByClassName("active")[0],e){const t=e.nextElementSibling;if(t)t!==e&&(t.classList.add("active"),e.classList.remove("active"));else{const t=this.rightOptionsDom.firstElementChild;t!==e&&(t.classList.add("active"),e.classList.remove("active"))}}}moveActiveLeftRight(){let e=this.leftOptionsDom.getElementsByClassName("active")[0];e?(this.rightOptionsDom.firstElementChild.classList.add("active"),e.classList.remove("active")):(e=this.rightOptionsDom.getElementsByClassName("active")[0],this.leftOptionsDom.firstElementChild.classList.add("active"),e.classList.remove("active"))}getLeftActiveIndex(){let e=-1;const t=this.leftOptionsDom.getElementsByClassName("active")[0];return t&&(e=parseInt(t.dataset.index)),e}getRightActiveIndex(){let e=-1;const t=this.rightOptionsDom.getElementsByClassName("active")[0];return t&&(e=parseInt(t.dataset.index)),e}open(e,t){this.dom.style.left=e+"px",this.dom.style.top=t+"px",super.open()}};class Ze extends Ve{constructor(e,t){super(e),this.title=t||"<missing title>"}render(e,t){Xe.setTitle(this.title),Xe.open(e,t)}setOptions(e,t){Xe.setOptions(e,t)}handleInput(){return super.handleInput(),Je.testPressed("up")?Xe.moveActiveUp():Je.testPressed("down")?Xe.moveActiveDown():Je.testPressed("left")||Je.testPressed("right")?Xe.moveActiveLeftRight():Je.testPressed("confirm")&&this.selectIndex(Xe.getLeftActiveIndex(),Xe.getRightActiveIndex()),null}selectIndex(){}exit(){Xe.close(),super.exit()}}class Ke extends Ze{constructor(e,t,n,s,o){super(t,n),this.callback=e,this.entityInteracted=s,this.lootableInteractable=o,this.updateTradeOptions()}updateTradeOptions(){const e=this.entityInteracted.getComponent("inventory"),t=[],n=e.items.get();for(const e of n)t.push(e);for(;t.length<e.capacity.get();)t.push(null);const s=[],o=this.lootableInteractable.items.get();for(const e of o)s.push(e);for(;s.length<this.lootableInteractable.capacity.get();)s.push(null);Xe.setOptions(t,s)}selectIndex(e,t){const n=this.entityInteracted.getComponent("inventory");if(e>-1){const t=n.getItem(e);this.lootableInteractable.addItem(t)&&n.removeByIndex(e),this.updateTradeOptions()}else if(t>-1){const e=this.lootableInteractable.getItem(t);n.addItem(e)&&this.lootableInteractable.removeByIndex(t),this.updateTradeOptions()}}}const Qe=new class extends w{constructor(){super('<div class="ui inventory">\n    <div class="inventory__equipment">\n\n    </div>\n    <div class="inventory__storage-wrap">\n\n    </div>\n    <div class="inventory__golddisplay">\n        <span class="inventory__gold-count"></span>\n        <span class="inventory__gold-text"> Gold</span>\n    </div>\n</div>'),this.equipmentDom=this.dom.getElementsByClassName("inventory__equipment")[0],this.equipmentSlots=[];for(let e=0;e<12;e++){const t=document.createElement("div");t.classList.add("slot","inventory__equipment-slot"),t.setAttribute("data-index",e),this.equipmentSlots.push(t),this.equipmentDom.appendChild(t)}this.storageWrapDom=this.dom.getElementsByClassName("inventory__storage-wrap")[0],this.goldCountDom=this.dom.getElementsByClassName("inventory__gold-count")[0],this.itemTooltipDom=document.createElement("div"),this.itemTooltipDom.classList.add("item__tooltip"),this.itemDragDom=document.createElement("div"),this.itemDragDom.classList.add("item__drag"),document.body.appendChild(this.itemTooltipDom),document.body.appendChild(this.itemDragDom),this.openStorages=[],this.itemsOnGround=[]}populateInventory(e){const t=e.getComponent("equipment");if(t){this.storageWrapDom.innerHTML="";for(let e=0;e<this.equipmentSlots.length;e++){const n=this.equipmentSlots[e],s=t.items[e].item;this.populateSlot(n,s)}this.openStorages=[];const e=t.items[9].item;e&&this.openEquipmentStorage(e);const n=t.items[7].item;n&&this.openEquipmentStorage(n);for(let e=0;e<this.equipmentSlots.length;e++){if(7===e||9===e)continue;const n=t.items[e].item;n&&this.openEquipmentStorage(n)}}this.openGroundItems();const n=e.getComponent("inventory");n&&(this.goldCountDom.innerText=n.gold)}openEquipmentStorage(e){this.openStorages.push(e);const t=e.getComponent("equippable");if(t&&0!==t.maxStorage){let n;n=-1===t.maxStorage?t.storage.length+1:t.maxStorage;const s=document.createElement("div");s.classList.add("inventory__storage"),s.setAttribute("data-index",this.openStorages.length-1);const o=document.createElement("div");o.classList.add("inventory__storage-title"),o.innerText=e.name,s.appendChild(o),this.inventorySlots=[];for(let e=0;e<n;e++){const n=document.createElement("div");n.classList.add("slot","inventory__storage-slot"),n.setAttribute("data-index",e),this.populateSlot(n,t.storage[e]),this.inventorySlots.push(n),s.appendChild(n)}this.storageWrapDom.appendChild(s)}}populateItemsAtGround(){const e=Ht.player.getComponent("position");this.itemsOnGround=[];for(const t of Ht.gameMap.items){const n=t.getComponent("position");e.isEqual(n)&&this.itemsOnGround.push(t)}}openGroundItems(){if(this.isOpen()){this.populateItemsAtGround();const e=10*Math.ceil((this.itemsOnGround.length+1)/10),t=document.createElement("div");t.classList.add("inventory__storage");const n=document.createElement("div");n.classList.add("inventory__storage-title"),n.innerText="On Ground",t.appendChild(n),this.inventorySlots=[];for(let n=0;n<e;n++){const e=document.createElement("div");e.classList.add("slot","pickup-slot"),e.setAttribute("data-index",n),this.populateSlot(e,this.itemsOnGround[n]),this.inventorySlots.push(e),t.appendChild(e)}this.storageWrapDom.appendChild(t)}}populateSlot(e,t){if(t){const n=t.getComponent("position");if(n){let s="";0!==n.zRot&&(s="transform: rotate("+180*n.zRot+"deg);"),e.classList.add("has-item");let o="<div class='item' style='color:"+n.color+";"+s+"'><div class='item__icon'>"+n.letter+"</div>";t.amount>1&&(o+="<span class='item__amount'>"+t.amount+"</span>"),o+="<div class='item__details'><span class='item__details-line item__name'>"+t.name+"</span>",t.description&&(o+="<span class='item__details-line item__description'>"+t.description+"</span>"),o+="<span class='item__details-line'><hr/></span>",o+=t.getComponentDescriptions(),o+="</div></div>",e.innerHTML=o}}else e.classList.remove("has-item"),e.innerHTML=""}toggle(){this.isOpen()?this.close():(this.open(),this.populateInventory(Ht.player))}};class $e extends U{constructor(e,t){super(e,t??[])}save(e,t){const n=[];if(this._value)for(const e of this._value)e&&n.push(JSON.stringify(e.save()));e[t][this._name]=n}load(e){const t=this._defaultValue,n=e[this._name];if(n)for(const e of n)if(null===e)t.push(e);else{let n;n=e.load?It.createFromTemplate(e.load,e):It.create(e),n.parentEntity=this.getParentComponent(),t.push(n)}this._value=t}}class et extends ue{constructor(e={}){super(e,"lootableInteractable"),this.isLooted=this.addArg(new U("isLooted",!0)),this.isOpen=this.addArg(new U("isOpen",!0)),this.capacity=this.addArg(new U("capacity",1)),this.openSprite=this.addArg(new U("openSprite","")),this.closedSprite=this.addArg(new U("closedSprite","")),this.items=this.addArg(new $e("items"))}interact(e){if(Ht.isPlayer(e)){Ht.eventHandler=new Ke((function(){return new ne}),Ht.eventHandler,"Viewing "+this.parentEntity.name+"'s Contents",e,this);const t=e.getComponent("position");Ht.eventHandler.render(64*t.x.get()*Ht.scale+100,64*t.y.get()*Ht.scale)}else this.parentEntity.id}addItem(e){if(!e)return!1;let t=!1;const n=this.items.get();for(let s=0;s<n.length;s++){const o=n[s]?.item;if(o&&(t=this.addPartialStacks(e),t))break}return t||(t=this.addFullStacks(e)),t}addFullStacks(e){this.clearSaveCache();const t=this.items.get();if(-1===this.capacity.get())t.push(e),e.parentEntity=this;else for(let n=0;n<this.capacity.get();n++)if(!t[n])return t[n]=e,e.parentEntity=this,!0;return!1}addPartialStacks(e){if(e.amount<=0)return!1;this.clearSaveCache();const t=e.amount;let n=e.amount;const s=this.items.get();let o;o=-1===this.capacity.get()?s.length:this.capacity.get();for(let t=0;t<o;t++){const o=s[t];if(o&&e.id===o.id){const t=o.maxStackSize-o.amount;if(t>=n)return o.setAmount(o.amount+n),!0;o.setAmount(o.amount+t),e.setAmount(e.amount-t),n-=t}}return t!==n}use(e,t){e.setAmount(e.amount-t),e.amount<=0&&this.remove(e),this.clearSaveCache()}removeByIndex(e){e>-1&&this.items.get().splice(e,1,null),this.clearSaveCache(),Ht.needsMapUpdate=!0}remove(e){const t=this.items.get().indexOf(e);this.removeByIndex(t)}getItem(e){return this.items.get()[e]}setItem(e,t){this.items.get()[e]=t,this.clearSaveCache()}move(e,t){const n=this.items.get();if(e!==t){const s=n[e];n[e]=n[t],n[t]=s,this.clearSaveCache(),Ht.isPlayer(this.parentEntity)&&Qe.populateInventory(Ht.player)}}drop(){}}const tt=new class extends w{constructor(){super('<div class="ui select-list">\n    <h1 class="select-list__title"></h1>\n    <ol class="select-list__options"></ol>\n</div>'),this.titleDom=this.dom.getElementsByClassName("select-list__title")[0],this.optionsDom=this.dom.getElementsByClassName("select-list__options")[0]}setTitle(e){this.titleDom.innerText=e}setOptions(e){this.optionsDom.innerHTML="";let t=0;for(const n of e){const e=document.createElement("li");e.classList.add("select-list__option"),e.dataset.index=t.toString(),0===t&&e.classList.add("active"),e.innerText=n,this.optionsDom.appendChild(e),t++}}moveActiveUp(){const e=this.optionsDom.getElementsByClassName("active")[0],t=e.previousElementSibling;if(t)t!==e&&(t.classList.add("active"),e.classList.remove("active"));else{const t=this.optionsDom.lastElementChild;t!==e&&(t.classList.add("active"),e.classList.remove("active"))}}moveActiveDown(){const e=this.optionsDom.getElementsByClassName("active")[0],t=e.nextElementSibling;if(t)t!==e&&(t.classList.add("active"),e.classList.remove("active"));else{const t=this.optionsDom.firstElementChild;t!==e&&(t.classList.add("active"),e.classList.remove("active"))}}getActiveIndex(){const e=this.optionsDom.getElementsByClassName("active")[0];return parseInt(e.dataset.index)}open(e,t){this.dom.style.left=e+"px",this.dom.style.top=t+"px",super.open()}},nt=tt;class st extends Ve{constructor(e,t,n){super(e),this.title=t||"<missing title>",this.options=n||[]}render(e,t){nt.setTitle(this.title),nt.setOptions(this.options),nt.open(e,t)}handleInput(){return super.handleInput(),Je.testPressed("up")?nt.moveActiveUp():Je.testPressed("down")?nt.moveActiveDown():Je.testPressed("confirm")&&this.selectIndex(nt.getActiveIndex()),null}selectIndex(){}exit(){nt.close(),super.exit()}}class ot extends st{constructor(e,t){super(t,"Peek or go down stairs?",["Peek down","Go down"]),this.callback=e}selectIndex(e){Ht.processAction(this.callback(e)),this.exit()}}class it extends ue{constructor(e={}){super(e,"stairsInteractable"),this.map=this.addArg(new U("map",null)),this.x=this.addArg(new U("x",null)),this.y=this.addArg(new U("y",null)),this.generator=this.addArg(new U("generator",null))}setPosition(e,t){this.x.set(e),this.y.set(t)}setMap(e){this.map.set(e)}setGenerator(e){this.generator.set(e)}interact(e){if(Ht.isPlayer(e)){const t=Ht.playerMap.level,n=Ht.nextMap.level,s=Ht.futureMap.level;let o,i=!1;if(t<n?o=Ht.nextMap:t<s&&(o=Ht.futureMap,i=!0),o.explored)return o.explored=!0,Ht.needsRenderUpdate=!0,o.addActor(Ht.player),Ht.playerMap.removeActor(Ht.player),Ht.playerMap=o,Ht.player.getComponent("position").moveTo(5,0),i&&(Ht.setNextMap(Ht.futureMap),Ht.setFutureMap(new Ft(11,11,{level:s+1})),Ht.futureMap.create()),new ne;{Ht.eventHandler=new ot((function(e){return o.explored=!0,Ht.needsRenderUpdate=!0,0===e||(i&&(Ht.setNextMap(Ht.futureMap),Ht.setFutureMap(new Ft(11,11,{level:s+1})),Ht.futureMap.create()),o.addActor(Ht.player),Ht.playerMap.removeActor(Ht.player),Ht.playerMap=o,Ht.player.getComponent("position").moveTo(5,0)),new ne}),Ht.eventHandler);const t=e.getComponent("position");Ht.eventHandler.render(64*t.x.get()*Ht.scale+100,64*t.y.get()*Ht.scale)}}else{const t=Ht.heroMap.level+1,n=(this.generator.get()||this.map.get())+"-"+t.toString(),s=Ht.getMap(n);!s||t>Ht.playerMap.level?C.text("The hero has gotten too far ahead.").build():(Ht.heroMap.removeActor(e),Ht.heroMap=s,Ht.heroMap.explored=!0,Ht.needsRenderUpdate=!0,Ht.heroMap.addActor(e),e.getComponent("position").moveTo(5,0),Ht.heroMap===Ht.nextMap&&(Ht.nextMap=Ht.futureMap,Ht.setFutureMap(new Ft(11,11,{level:Ht.futureMap.level+1})),Ht.futureMap.create()))}}}class at extends ue{constructor(e={}){super(e,"trapDoorInteractable"),this.map=this.addArg(new U("map",null)),this.x=this.addArg(new U("x",null)),this.y=this.addArg(new U("y",null)),this.generator=this.addArg(new U("generator",null))}setPosition(e,t){this.x.set(e),this.y.set(t)}setMap(e){this.map.set(e)}setGenerator(e){this.generator.set(e)}interact(){if(this.map.get());else if(this.generator.get()){const e={};Ht.playerMap.level&&(e.level=Ht.playerMap.level);const t=Ht.mapLoader.loadMap(this.generator.get(),e);t.create(),t.explored=!0,Ht.setShopMap(t,this),this.setMap(t.name),this.setGenerator(null)}}}class rt extends U{constructor(e,t){super(e,t)}save(e,t){return this._value!==this._defaultValue&&(e[t]=this._value),e}load(e){"boolean"==typeof e?this._value=e:"object"==typeof e&&(this._value=e[this._name]),this._value=this._value??this._defaultValue}}class lt extends j{constructor(e={}){super(e,"blocksFov"),this.blocksFov=this.addArg(new rt("blocksFov",!1))}}class ct extends j{constructor(e={}){super(e,"blocksMovement"),this.blocksMovement=this.addArg(new rt("blocksMovement",!1))}onEntityDeath(){this.blocksMovement.set(!1)}}class ht extends j{constructor(e={}){super(e,"cleanable"),this.decreasesTo=this.addArg(new U("decreasesTo","")),this.increasesTo=this.addArg(new U("increasesTo",""))}perform(){}}class dt extends U{constructor(e,t){super(e,t??[])}save(e,t){this._value&&(e[t][this._name]=this._value.toString())}load(e){const t=this._defaultValue,n=e[this._name].split(",");for(const e of n)t.push(e);this._value=t}}class pt extends j{constructor(e={}){super(e,"faction"),this.factions=this.addArg(new dt("factions")),this.enemies=this.addArg(new dt("enemies"))}isEnemyOf(e){if(!e)return!1;for(const t of this.factions.get())if(e.enemies.get().indexOf(t)>-1)return!0;return!1}}const mt=new class extends w{constructor(){super('<div class="ui player-info">\n    <div class="player-health">\n        <div class="player-health__fg"></div>\n        <div class="player-health__text"></div>\n    </div>\n    <div class="player-stats">\n        <div class="player-stat">Power: <span class="player-power"></span></div>\n        <div class="player-stat">Defense: <span class="player-defense"></span></div>\n    </div>\n</div>'),this.healthFgDom=this.dom.getElementsByClassName("player-health__fg")[0],this.healthTextDom=this.dom.getElementsByClassName("player-health__text")[0],this.powerDom=this.dom.getElementsByClassName("player-power")[0],this.defenseDom=this.dom.getElementsByClassName("player-defense")[0]}updateHealth(e,t){const n=e/t*100;this.healthFgDom.style.width=n+"%",this.healthTextDom.innerText="HP: "+e+" / "+t}updatePower(e){this.powerDom.innerText=e}updateDefense(e){this.defenseDom.innerText=e}};class ut extends j{constructor(e){super(e,"fighter"),this.baseHp=this.addArg(new U("baseHp",0)),this.hp=this.addArg(new U("hp",null)),this.baseDefense=this.addArg(new U("baseDefense",0)),this.baseDamage=this.addArg(new U("baseDamage",0)),this.minDamage=0,this.maxDamage=0,this.defense=0}setHp(e){this.hp.set(Math.max(0,Math.min(e,this.maxHp))),this.updateUI()}heal(e){if(this.hp.get()===this.maxHp)return 0;const t=Math.min(this.maxHp,this.hp.get()+e),n=t-this.hp.get();return this.setHp(t),n}takeDamage(e){this.setHp(this.hp.get()-e),this.hp.get()<=0&&this.die()}die(){const e=this.parentEntity;Ht.isPlayer(this.parentEntity)?C.text("You died!","#f00").build():"hero"===this.parentEntity.id?(C.text(e.name+" dies!","#ffa030").build(),C.text("You managed to keep the hero alive for "+Ht.heroMap.level+" levels!","#ffa030").build()):C.text(e.name+" dies!","#ffa030").build(),e.callEvent("onEntityDeath");const t=e.getComponent("ai");if(t){const n={components:{aiDead:{previousAI:t.type}}};e.removeComponent("ai"),e.setComponent(new X(n))}e.sprite="rltiles_corpse",e.name="Corpse of "+this.name,this.clearSaveCache(),e.clearSaveCache()}getDamage(){return this.minDamage===this.maxDamage?this.minDamage:Q.randomInt(this.minDamage,this.maxDamage)}getDamageDisplay(){return this.minDamage===this.maxDamage?this.minDamage:this.minDamage+" - "+this.maxDamage}getBlockedDamage(){return Math.floor(Q.randomNumber(this.defense/10,this.defense)/10)}getMaxHp(){const e=this.baseHp.get();let t=0;const n=this.parentEntity.getComponent("equipment");if(n){const e=n.getEquippables();for(const n of e)t+=n.health}return e+t}recalculateStats(e=!0){const t=this.getMaxHp();(null===this.hp.get()||this.hp>=this.maxHp)&&this.hp.set(t),this.maxHp=t,this.calculateDamage(),this.calculateDefense(),this.updateUI(),e&&this.clearSaveCache()}calculateDamage(){const e=this.baseDamage.get();let t=0,n=0;const s=this.parentEntity.getComponent("equipment");if(s){const e=s.getEquippables();for(const s of e)t+=s.minDamage,n+=s.maxDamage}this.minDamage=e+t,this.maxDamage=Math.floor(1.5*e)+n}calculateDefense(){const e=this.baseDefense.get();let t=0;const n=this.parentEntity.getComponent("equipment");if(n){const e=n.getEquippables();for(const n of e)t+=n.defense}this.defense=e+t}updateUI(){Ht.isPlayer(this.parentEntity)?(mt.updateHealth(this.hp.get(),this.maxHp),mt.updatePower(this.getDamageDisplay()),mt.updateDefense(this.defense)):"hero"===this.parentEntity.id&&(Z.updateHealth(this.hp.get(),this.maxHp),Z.updatePower(this.getDamageDisplay()),Z.updateDefense(this.defense))}onComponentsLoaded(){this.recalculateStats(!1)}onEquipmentChange(){this.recalculateStats()}}class _t extends j{constructor(e={}){super(e,"inventory"),this.capacity=this.addArg(new U("capacity",3)),this.items=this.addArg(new $e("items"))}addItem(e){if(!e)return!1;let t=!1;const n=this.items.get();for(let s=0;s<n.length;s++){const o=n[s]?.item;if(o&&(t=this.addPartialStacks(e),t))break}return t||(t=this.addFullStacks(e)),t}addFullStacks(e){this.clearSaveCache();const t=this.items.get();if(-1===this.capacity.get())t.push(e),e.parentEntity=this;else for(let n=0;n<this.capacity.get();n++)if(!t[n])return t[n]=e,e.parentEntity=this,!0;return!1}addPartialStacks(e){if(e.amount<=0)return!1;this.clearSaveCache();const t=e.amount;let n=e.amount;const s=this.items.get();let o;o=-1===this.capacity.get()?s.length:this.capacity.get();for(let t=0;t<o;t++){const o=s[t];if(o&&e.id===o.id){const t=o.maxStackSize-o.amount;if(t>=n)return o.setAmount(o.amount+n),!0;o.setAmount(o.amount+t),e.setAmount(e.amount-t),n-=t}}return t!==n}use(e,t){e.setAmount(e.amount-t),e.amount<=0&&this.remove(e),this.clearSaveCache()}removeByIndex(e){e>-1&&this.items.get().splice(e,1,null),this.clearSaveCache(),Ht.needsMapUpdate=!0}remove(e){const t=this.items.get().indexOf(e);this.removeByIndex(t)}getItem(e){return this.items.get()[e]}setItem(e,t){this.items.get()[e]=t,this.clearSaveCache()}move(e,t){const n=this.items.get();if(e!==t){const s=n[e];n[e]=n[t],n[t]=s,this.clearSaveCache(),Ht.isPlayer(this.parentEntity)&&Qe.populateInventory(Ht.player)}}drop(){}}class gt extends f{constructor(e,t,n,s){super(e),this.item=t,this.x=n,this.y=s}perform(){const e=this.item.getComponent("consumable");if(e)return e.activate(this,this.x,this.y)}getTargetActor(e){return e.getAliveActorAtLocation(this.x,this.y)}}class ft extends j{constructor(e={},t){super(e,"consumable",t)}save(){return super.save()}getConsumer(){let e=this.parentEntity;for(;e&&"actor"!==e.type;)e=e.parentEntity;return e}getItem(){return this.parentEntity}getAction(){return new gt(this.getConsumer(),this.getItem())}activate(e){console.error("Not Implemented")}consume(){const e=this.getItem(),t=e.parentEntity;t&&t.use(e,1)}}class vt extends ft{constructor(e={}){super(e,"healingConsumable"),this.amount=this.addArg(new U("amount",0))}activate(e){const t=e.entity.getComponent("fighter");if(t){const n=t.heal(this.amount.get());return n>0?(this.consume(),this.isPlayer()&&C.text("You consume the "+this.parentEntity.name+", and recover "+n+" HP!").build(),this):new b(e.entity,"Your health is already full")}}getDescription(){return"<span class='item__details-line'>Recovers <span style='color: #c00;'>"+this.amount.get()+"</span> health</span>"}}const bt=new class{constructor(){this.types=new Map,this.init()}init(){this.load(new X),this.load(new pe),this.load(new me),this.load(new et),this.load(new it),this.load(new at),this.load(new vt),this.load(new lt),this.load(new ct),this.load(new ht),this.load(new pt),this.load(new ut),this.load(new R),this.load(new _t),this.load(new K)}load(e){this.types.set(e.type,e)}create(e,t,n){return new(0,this.types.get(t).constructor)(n)}},yt=new class extends w{constructor(){super('<div class="ui details"></div>')}updatePlayerDetails(){}getPosition(e){const t=e.getComponent("position");return"<span class='details__line'>Looking at: X:"+t.x.get()+" - Y:"+t.y.get()+"</span>"}updatePositionOnly(e){this.dom.innerHTML=this.getPosition(e)}updatePositionDetails(){}},At=new class{constructor(){this.setupGameHtml(),window.addEventListener("resize",this)}setupGameHtml(){const e=document.createElement("div");e.classList.add("game"),this.canvas=document.createElement("canvas"),this.canvas.classList.add("view"),e.appendChild(this.canvas),Z.open(),Z.appendTo(e),nt.appendTo(e),Xe.appendTo(e),mt.open(),I.open(),x.open(),yt.open(),mt.appendTo(yt.dom),I.appendTo(yt.dom),x.appendTo(yt.dom),yt.appendTo(e),document.body.appendChild(e),this.ctx=this.canvas.getContext("2d")}handleEvent(e){"resize"===e.type&&this.resizeCanvas()}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight;const e=this.canvas.width/2560,t=this.canvas.height/1440;Ht.scale=Math.min(e,t),Ht.needsRenderUpdate=!0}clearAll(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}};class wt{constructor(e){this.args=e,this.type=e.type||"entity",this.id=e.id,this.name=e.name||"",this.description=e.description||"",this.sprite=e.sprite||"",this.letter=e.letter||"?",this.color=e.color||"#fff",this.componentArray=[],this.components={},e.components&&(this.loadComponents(e,e.components),this.callEvent("onComponentsLoaded")),this.cachedSave=null}clone(){console.error("Not implemented")}callEvent(e,t){for(const n of this.componentArray)n[e]?.(t);this[e]?.(t)}draw(e,t){const n=this.getComponent("position");n&&Ht.spriteManager.getImage(this.sprite).drawImage(At.ctx,64*(n.x.get()+e),64*(n.y.get()+t))}loadComponents(e,t){const n=this;Object.keys(t).forEach((function(t){const s=bt.types.get(t);if(s){const o=s.baseType;n.getComponent(o)||n.setComponent(bt.create(this,t,e),!1)}}))}setComponent(e){e.parentEntity=this,this.components[e.baseType]=e,this.componentArray.push(e)}getComponent(e){return this.components[e]}removeComponent(e){if(this.components[e]){this.components[e]=void 0;for(const t of this.componentArray)if(t.baseType===e){const e=this.componentArray.indexOf(t);this.componentArray.splice(e,1);break}}}clearSaveCache(){this.cachedSave=null}save(){if(null!==this.cachedSave)return this.cachedSave;const e={id:this.id,type:this.type,name:this.name,description:this.description,sprite:this.sprite,letter:this.letter,color:this.color,components:{}};for(const t of this.componentArray){const n=t.save();null!==n&&n!=={}&&J.deep(e.components,n)}return this.cachedSave=e,e}loadArg(e,t){return this.args[e]||t}}class xt extends wt{constructor(e={}){e.type="actor",super(e),this.fov=new Y}clone(){return new xt(this.save())}isAlive(){const e=this.getComponent("fighter");return e&&e.hp.get()>0}}class kt extends wt{constructor(e={}){e.type="tile",super(e)}clone(){return new kt(this.save())}save(){return super.save()}isWall(){return this.getComponent("blocksMovement")?.blocksMovement.get()}}class Ct extends wt{constructor(e={}){e.type="item",super(e),this.amount=this.loadArg("amount",1),this.maxStackSize=this.loadArg("maxStackSize",1)}save(){const e=super.save();return 1!==this.amount&&(e.amount=this.amount),1!==this.maxStackSize&&(e.maxStackSize=this.maxStackSize),e}clone(){return new Ct(this.save())}setAmount(e){this.amount=e,this.clearSaveCache()}}const It=new class{constructor(){this.types=new Map,this.templates=new Map,this.loaded=!1,this.init()}init(){this.load(new xt),this.load(new kt),this.load(new Ct),this.loadTemplates()}load(e){this.types.set(e.type,e)}create(e,t={}){let n;if(n="object"==typeof e?e:JSON.parse(e),void 0!==n.extends){if(this.templates.has(n.extends)){const e=JSON.parse(this.templates.get(n.extends));return delete n.extends,this.create(J.deep(e,n),t)}console.error("Json template for id '"+n.extends+"' is missing. Cannot extend from it.")}return new(this.types.get(n.type).constructor)(J.deep(n,t))}createFromTemplate(e,t={}){return this.templates.has(e)?this.create(this.templates.get(e),t):(console.error("Json template for id '"+e+"' is missing."),null)}isLoaded(){return this.loaded}loadTemplate(e){for(const t of e){const e=t.id;this.templates.has(e)?console.error("Template for entity id '"+e+"' already exists."):this.templates.set(e,JSON.stringify(t))}}loadTemplates(){const e=n(798),t=e.keys().length;let s=0;e.keys().forEach((n=>{e(n).then((e=>{this.loadTemplate(e),s++,s===t&&(this.loaded=!0)}))}))}};class Mt{constructor(e,t,n,s){this.name=e,this.displayName=t,this.width=n,this.height=s,this.timeout=null,this.saveCache=null,this.explored=!1,this.init()}init(){this.tiles=H.create2dArray(this.width),this.actors=[],this.items=[]}create(){}teardown(){this.timeout&&clearTimeout(this.timeout),Ht.player.fov.teardown();for(let e=0;e<this.width;e++)for(let t=0;t<this.height;t++){const n=this.tiles[e][t];n&&n.callEvent("onMapTeardown")}for(const e of this.actors)e.callEvent("onMapTeardown");for(const e of this.items)e.callEvent("onMapTeardown")}removeEntity(e){e instanceof xt?this.removeActor(e):e instanceof Ct&&this.removeItem(e)}removeItem(e){const t=this.items.indexOf(e);t>-1&&this.items.splice(t,1)}addItem(e,t){const n=e.getComponent("position");t||(t=n);let s=e.amount;for(const o of this.items)if(o.id===e.id){const i=o.getComponent("position");if(i&&t.isEqual(i)){if(-1===o.maxStackSize)return o.setAmount(o.amount+e.amount),n.teardown(),!1;const t=o.maxStackSize-o.amount;if(t>=s)return o.setAmount(o.amount+s),n.teardown(),!1;o.setAmount(o.amount+t),e.setAmount(e.amount-t),s-=t}}return s>0?(e.setAmount(s),n.moveTo(t.x.get(),t.y.get()),e.parent=null,this.items.push(e),n.setVisible(),!0):(n.teardown(),!1)}removeActor(e){const t=this.actors.indexOf(e);t>-1&&this.actors.splice(t,1)}addActor(e){this.actors.push(e)}save(){const e={name:this.name,displayName:this.displayName,width:this.width,height:this.height,explored:this.explored,tiles:{}},t=[],n=[];let s="",o=65;for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++){const a=this.tiles[e][i];if(a){const e=JSON.stringify(a.save()),i=t.indexOf(e);i>-1?s+=n[i]:(t.push(e),n.push(String.fromCharCode(o)),s+=String.fromCharCode(o),o++)}else s+=" "}e.tiles={},e.tiles.key=s,e.tiles.map={};for(let s=0;s<t.length;s++)e.tiles.map[n[s]]=t[s];const i=[];for(const e of this.actors)i.push(JSON.stringify(e.save()));e.actors=i;const a=[];for(const e of this.items)a.push(JSON.stringify(e.save()));return e.items=a,this.saveCache=e,e}load(e){const t=e.tiles;this.explored=e.explored,this.displayName=e.displayName;for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++){const s=t[e*this.height+n];s&&(t[e][n]=It.create(s,{components:{position:{x:e,y:n}}}))}const n=e.actors;for(const e of n){const t=It.create(e);this.addActor(t)}const s=e.items;for(const e of s){const t=It.create(e);this.items.push(t)}}isInBounds(e,t){return 0<=e&&e<this.width&&0<=t&&t<this.height}revealFromPosition(e,t,n,s=25){const o=this,i=Math.max(0,e-n),a=Math.min(this.width,e+n),r=Math.max(0,t-n),l=Math.min(this.height,t+n);0===s?o._revealGradually(i,a,r,l,e,t,1,n,s):o.timeout=setTimeout((function(){o._revealGradually(i,a,r,l,e,t,1,n,s)}),s)}_revealGradually(e,t,n,s,o,i,a,r,l){const c=this;c.timeout=null,a<=r&&(c.timeout=setTimeout((function(){c._revealGradually(e,t,n,s,o,i,a+1,r,l)}),l));const h=o-a,d=o+a,p=i-a,m=i+a;for(let e=h;e<=d;e++){const t=e===h||e===d;for(let n=p;n<=m;n++)(t||n===p||n===m)&&(this._revealAtPosition(e,n),Ht.needsMapUpdate=!0)}return!0}_revealAtPosition(e,t){if(this.tiles[1][e]){const n=this.tiles[1][e][t];n&&n.getComponent("position")&&(n.getComponent("fov")||n.setComponent(new R({components:{fov:{explored:!0,visible:!1}}})))}}getAliveActorAtLocation(e,t){let n=null;for(const s of this.actors)if(s.isAlive()){const o=s.getComponent("position");if(o&&o.isAt(e,t)){n=s;break}}return n}getBlockingActorAtLocation(e,t){let n=null;for(const s of this.actors){const o=s.getComponent("position");if(o&&o.isAt(e,t)&&s.getComponent("blocksMovement")?.blocksMovement.get()){n=s;break}}return n}getCleanableActorAtLocation(e,t){let n=null;for(const s of this.actors){const o=s.getComponent("position");if(o&&o.isAt(e,t)&&s.getComponent("cleanable")){n=s;break}}return n}addPlayer(e,t){Ht.player||(Ht.player=It.createFromTemplate("player")),this.addActor(Ht.player),Ht.player.getComponent("position").moveTo(e,t),this.updatePlayerUI()}updatePlayerUI(){yt.updatePlayerDetails()}draw(e=0,t=0){if(this.explored){const n=this.tiles;for(let s=0;s<n.length;s++){const o=n[s];for(let n=0;n<o.length;n++){const s=o[n];s&&s.draw(e,t)}}for(const n of this.items)n.draw(e,t);for(const n of this.actors)n.draw(e,t)}else Ht.spriteManager.getImage("map").drawImage(At.ctx,64*e,64*t);At.ctx.font="20vh serif",At.ctx.textAlign="center",At.ctx.globalAlpha=.1;let n=this.level;this.name.startsWith("shop")&&(n="$ "+n),At.ctx.fillText(n,(64*e+352)*Ht.scale,(64*t+444)*Ht.scale),At.ctx.globalAlpha=1}}class Bt{constructor(){}placeEntities(){}}const Et=[],Tt=JSON.parse('[{"id":"potion","items":[{"id":"potion_health","weight":30}]}]'),St=JSON.parse('[{"id":"lootable_containers","tiles":[{"id":"barrel","weight":100},{"id":"barrels","weight":75},{"id":"barrels_stacked","weight":50},{"id":"chest","weight":25}]}]'),Dt=JSON.parse('[{"level":1,"actors":[{"id":"rat_small","weight":50},{"id":"rat","weight":30},{"id":"lizard_giant","weight":20},{"id":"web","weight":50},{"id":"blood_large","weight":50}],"items":[{"group":"potion","weight":50}],"tiles":[{"group":"lootable_containers","weight":50}]}]'),zt=JSON.parse('[{"level":1,"actors":[{"id":"web_large","weight":50},{"id":"web","weight":50},{"id":"blood_large","weight":50},{"id":"blood_medium","weight":50},{"id":"blood_small","weight":50},{"id":"rat","weight":500}],"items":[{"group":"potion","weight":50}],"tiles":[{"group":"lootable_containers","weight":50}]}]'),Lt=new class{constructor(){this.entityGroups=new Map,this.itemGroups=new Map,this.tileGroups=new Map,this.generators=new Map,this.loadEntityGroups(Et),this.loadItemGroups(Tt),this.loadTileGroups(St),this.loadGenerator("basic-dungeon",Dt),this.loadGenerator("tutorial",zt)}loadEntityGroups(e){for(const t of e)this.entityGroups.set(t.id,t.entities)}loadItemGroups(e){for(const t of e)this.itemGroups.set(t.id,t.items)}loadTileGroups(e){for(const t of e)this.tileGroups.set(t.id,t.tiles)}loadGenerator(e,t){this.generators.set(e,t)}getChancesForLevel(e,t){let n;const s=this.generators.get(e);for(const e of s){if(e.level>t)break;n=e}return n}getActorForLevel(e,t){const n=this.getChancesForLevel(e,t).actors;let s=this.getRandomFromGroup(n);for(;void 0!==s.group;){const e=this.entityGroups.get(s.group);s=this.getRandomFromGroup(e)}return s.id}getItemForLevel(e,t){const n=this.getChancesForLevel(e,t).items;let s=this.getRandomFromGroup(n);for(;void 0!==s.group;){const e=this.itemGroups.get(s.group);s=this.getRandomFromGroup(e)}return s.id}getTileForLevel(e,t){const n=this.getChancesForLevel(e,t).tiles;let s=this.getRandomFromGroup(n);for(;void 0!==s.group;){const e=this.tileGroups.get(s.group);s=this.getRandomFromGroup(e)}return s.id}getRandomFromGroup(e){let t,n=0;for(const t of e)n+=t.weight;let s=0;const o=Q.randomNumber(0,n);for(const n of e)if(s+=n.weight,o<s){t=n;break}return t}};class Nt extends Bt{constructor(e,t,n,s){super(),this.x1=e,this.y1=t,this.x2=e+n,this.y2=t+s,this.width=n,this.height=s}getCenterX(){return Math.round((this.x1+this.x2)/2)}getCenterY(){return Math.round((this.y1+this.y2)/2)}intersects(e){return this.x1<=e.x2&&this.x2>=e.x1&&this.y1<=e.y2&&this.y2>=e.y1}createRoom(e){const t=Math.max(0,this.x1),n=Math.min(e.width,this.x2+1),s=Math.max(0,this.y1),o=Math.min(e.height,this.y2+1),i=It.createFromTemplate("floor",{components:{position:{x:0,y:0}}}),a=It.createFromTemplate("floor_center",{components:{position:{x:0,y:0}}}),r=It.createFromTemplate("floor_cracked",{components:{position:{x:0,y:0}}}),l=It.createFromTemplate("wall",{components:{position:{x:0,y:0}}});for(let c=t;c<n;c++)for(let t=s;t<o;t++){let n;const s=Math.random();n=s<.06?r.clone():s<.1?a.clone():i.clone(),n.getComponent("position").moveTo(c,t),e.tiles[c][t]=n;const o=(c===this.x1||c===this.x2)&&t>=this.y1&&t<=this.y2,h=(t===this.y1||t===this.y2)&&c>=this.x1&&c<=this.x2,d=e.tiles[c][t];if((h||o)&&!d){const n=l.clone();n.getComponent("position").moveTo(c,t),e.tiles[c][t]=n}}}placeTiles(e,t,n,s,o){const i=Q.randomInt(s,o);for(let s=0;s<i;s++){const s=Q.randomInt(this.x1+1,this.x2-1),o=Q.randomInt(this.y1+1,this.y2-1);if(!e.getBlockingActorAtLocation(s,o)){const i={components:{position:{x:s,y:o}}},a=Lt.getTileForLevel(t,n);e.tiles[s][o]=It.createFromTemplate(a,i)}}}placeEntities(e,t,n,s,o){const i=Q.randomInt(s,o);for(let s=0;s<i;s++){const s=Q.randomInt(this.x1+1,this.x2-1),o=Q.randomInt(this.y1+1,this.y2-1);if(!e.getBlockingActorAtLocation(s,o)){const i={components:{position:{x:s,y:o}}},a=Lt.getActorForLevel(t,n),r=It.createFromTemplate(a,i);e.addActor(r)}}}placeItems(e,t,n,s){const o=Q.randomInt(0,s);for(let s=0;s<o;s++){const s={components:{position:{x:Q.randomInt(this.x1+1,this.x2-1),y:Q.randomInt(this.y1+1,this.y2-1)}}},o=Lt.getItemForLevel(t,n),i=It.createFromTemplate(o,s);e.items.push(i)}}}class Ft extends Mt{constructor(e,t,n={}){const s=n.level||1;super("basic-dungeon-"+s,"Dungeon Level "+s,e,t),this.maxRooms=n.maxRooms||1,this.roomMinSize=n.roomMinSize||8,this.roomMaxSize=n.roomMaxSize||8,this.level=s,this.minTilesByFloor=[{level:1,amount:2},{level:4,amount:3},{level:7,amount:4}],this.maxTilesByFloor=[{level:1,amount:4},{level:4,amount:6},{level:7,amount:8}],this.minMonstersByFloor=[{level:1,amount:0},{level:4,amount:1},{level:7,amount:2}],this.maxMonstersByFloor=[{level:1,amount:2},{level:4,amount:3},{level:7,amount:4}],this.minItemsByFloor=[{level:1,amount:0},{level:4,amount:1},{level:6,amount:2}],this.maxItemsByFloor=[{level:1,amount:2},{level:4,amount:3},{level:6,amount:5}]}getFloorAmount(e){let t=0;for(const n of e){if(n.level>this.level)break;t=n.amount}return t}save(){const e=super.save();return 1!==this.level&&(e.level=this.level),this.saveCache=e,e}create(e,t){super.create();const n=It.createFromTemplate("wall",{components:{position:{x:0,y:0}}});for(let e=0;e<this.height;e++)for(let t=0;t<this.width;t++){const s=n.clone();s.getComponent("position").moveTo(t,e),this.tiles[t][e]=s}const s=[];for(let e=0;e<this.maxRooms;e++){const n=Q.randomInt(this.roomMinSize,this.roomMaxSize),o=Q.randomInt(this.roomMinSize,this.roomMaxSize);let i=10*e+1,a=1;e>=this.maxRooms/2&&(a=11,i-=30);const r=new Nt(i,a,n,o);let l=!1;for(const e of s)if(r.intersects(e)){l=!0;break}if(!l){if(r.createRoom(this),0===s.length){const e=r.getCenterX();t&&t.setPosition(e,0),this.tiles[e][0]=It.createFromTemplate("stairs_up",{components:{position:{x:e,y:0}}});const n=Q.randomInt(r.x1+2,r.x2-2),s=Q.randomInt(r.y1+2,r.y2-2);this.tiles[n][s]=It.createFromTemplate("stairs_down",{components:{position:{x:n,y:s},stairsInteractable:{generator:"basic-dungeon"}}});let o=n,i=s;for(;o===n&&i===s;)o=Q.randomInt(r.x1+2,r.x2-2),i=Q.randomInt(r.y1+2,r.y2-2),o===n&&i===s||(this.tiles[o][i]=It.createFromTemplate("trap_door",{components:{position:{x:o,y:i},trapDoorInteractable:{generator:"shop"}}}))}s.push(r)}}for(const e of s)e.placeTiles(this,"basic-dungeon",this.level,this.getFloorAmount(this.minTilesByFloor),this.getFloorAmount(this.maxTilesByFloor)),e.placeEntities(this,"basic-dungeon",this.level,this.getFloorAmount(this.minMonstersByFloor),this.getFloorAmount(this.maxMonstersByFloor)),e.placeItems(this,"basic-dungeon",this.level,this.getFloorAmount(this.minItemsByFloor),this.getFloorAmount(this.maxItemsByFloor))}}class Ot extends Mt{constructor(e,t,n={}){const s=n.level||1;super("shop-"+s,"Shop",e,t),this.maxRooms=n.maxRooms||1,this.roomMinSize=n.roomMinSize||8,this.roomMaxSize=n.roomMaxSize||8,this.level=s,this.minMonstersByFloor=[{level:1,amount:2}],this.maxMonstersByFloor=[{level:1,amount:2}],this.minItemsByFloor=[{level:1,amount:2}],this.maxItemsByFloor=[{level:1,amount:2}]}getFloorAmount(e){let t=0;for(const n of e){if(n.level>this.level)break;t=n.amount}return t}save(){const e=super.save();return 1!==this.level&&(e.level=this.level),this.saveCache=e,e}create(e,t){super.create();const n=It.createFromTemplate("wall",{components:{position:{x:0,y:0}}});for(let e=0;e<this.height;e++)for(let t=0;t<this.width;t++){const s=n.clone();s.getComponent("position").moveTo(t,e),this.tiles[t][e]=s}const s=[];for(let e=0;e<this.maxRooms;e++){const e=Q.randomInt(this.roomMinSize,this.roomMaxSize),n=Q.randomInt(this.roomMinSize,this.roomMaxSize),o=new Nt(1,1,e,n);if(o.createRoom(this),0===s.length){const e=o.getCenterX(),n=o.getCenterY();t&&t.setPosition(e,n),this.tiles[e][n]=It.createFromTemplate("stairs_down",{components:{position:{x:e,y:n},stairsInteractable:{generator:"basic-dungeon"}}});for(let e=o.x1+2;e<o.x2-1;e++)this.tiles[e][3]=It.createFromTemplate("table",{components:{position:{x:e,y:3}}}),this.tiles[e][7]=It.createFromTemplate("table",{components:{position:{x:e,y:7}}})}s.push(o)}}}class qt{constructor(){}loadMap(e,t={}){switch(e){case"basic-dungeon":return new Ft(11,11,t);case"shop":return new Ot(11,11,t);default:return null}}}const Pt=new class{constructor(){this.eventHandler=null,this.player=null,this.gameMaps=new Map,this.playerMap=null,this.heroMap=null,this.nextMap=null,this.futureMap=null,this.shopMap=null,this.needsRenderUpdate=!1,this.textureManager=null,this.spriteManager=null,this.scale=1,this.mapLoader=new qt}initTextures(){this.textureManager=new B,this.textureManager.addTexture("sprites",S),this.textureManager.addTexture("player",D),this.textureManager.addTexture("scribble",z),this.textureManager.addTexture("rltiles",O),this.textureManager.addTexture("webs",N),this.textureManager.addTexture("map",P),this.spriteManager=new T,this.spriteManager.addImage("placeholder","sprites",0,0),this.spriteManager.addImage("map","map",0,0,704,704),this.textureManager.loadJson("rltiles",q),this.textureManager.loadJson("scribble",L),this.textureManager.loadJson("webs",F)}handleEvents(){this.processAction(this.eventHandler.handleInput())}processAction(e){if(e&&this.eventHandler.isPlayerTurn){const t=e.perform(Pt.playerMap);return!(t instanceof v||(t instanceof b?(t.reason&&C.text(t.reason).build(),1):(Pt.needsRenderUpdate=!0,Pt.player.fov.compute(Pt.playerMap,Pt.player,5),Pt.player.fov.updateMap(),I.updatePlayerDetails(this.player,this.playerMap),this.handleEnemyTurns(),0)))}}handleEnemyTurns(){this.eventHandler.isPlayerTurn=!1;for(const e of this.heroMap.actors)if(e!==this.player){const t=e.getComponent("ai");t&&t.perform(this.heroMap)}if(this.shopMap)for(const e of this.shopMap.actors)if(e!==this.player){const t=e.getComponent("ai");t&&t.perform(this.shopMap)}if(this.nextMap)for(const e of this.nextMap.actors)if(e!==this.player){const t=e.getComponent("ai");t&&t.perform(this.nextMap)}if(this.futureMap)for(const e of this.futureMap.actors)if(e!==this.player){const t=e.getComponent("ai");t&&t.perform(this.futureMap)}this.eventHandler.isPlayerTurn=!0}clearMaps(){this.player=null,this.gameMaps=new Map}setHeroMap(e){const t=this.heroMap;t!==e&&(this.heroMap=e,this.addMap(e),t&&t.save(),e.save(),this.heroMap.updatePlayerUI(),this.needsRenderUpdate=!0)}setNextMap(e){const t=this.nextMap;t!==e&&(this.nextMap=e,this.addMap(e),t&&t.save(),e.save(),this.nextMap.updatePlayerUI(),this.needsRenderUpdate=!0)}setFutureMap(e){const t=this.futureMap;t!==e&&(this.futureMap=e,this.addMap(e),t&&t.save(),e.save(),this.futureMap.updatePlayerUI(),this.needsRenderUpdate=!0)}setShopMap(e){const t=this.playerMap;t!==e&&(t&&t.removeActor(this.player),this.playerMap=e,this.shopMap=e,this.addMap(e),t&&t.save(),e.save(),this.player&&-1===this.shopMap.actors.indexOf(this.player)&&(this.shopMap.actors.push(this.player),this.player.getComponent("position").moveTo(5,5)),this.shopMap.updatePlayerUI(),this.needsRenderUpdate=!0)}getMap(e){return this.gameMaps.get(e)}addMap(e){this.gameMaps.has(e.name)||this.gameMaps.set(e.name,e)}draw(){this.heroMap.draw(),this.nextMap&&this.nextMap.draw(0,11),this.futureMap&&this.futureMap.draw(11,11),this.shopMap&&this.shopMap.draw(22,0)}save(e){const t=[];for(const e of this.gameMaps.values())t.push(e.save());const n={name:e,date:new Date,playerMap:this.playerMap.name,heroMap:this.heroMap.name,nextMap:this.nextMap.name,shopMap:this.shopMap.name,maps:t};localStorage.setItem(e,JSON.stringify(n))}load(){}isPlayer(e){return e===this.player}},Ht=Pt;class jt extends _e{constructor(){super()}teardown(){super.teardown()}handleInput(){let e=null;return this.isPlayerTurn&&Ht.player.isAlive()&&(Je.testPressed("up")?e=new he(Ht.player,0,-1):Je.testPressed("down")?e=new he(Ht.player,0,1):Je.testPressed("left")?e=new he(Ht.player,-1,0):Je.testPressed("right")?e=new he(Ht.player,1,0):Je.testPressed("nw")?e=new he(Ht.player,-1,-1):Je.testPressed("ne")?e=new he(Ht.player,1,-1):Je.testPressed("sw")?e=new he(Ht.player,-1,1):Je.testPressed("se")?e=new he(Ht.player,1,1):Je.testPressed("wait")?e=new ne(Ht.player):Je.testPressed("confirm")&&(e=new de(Ht.player))),e}onMouseMove(e){this.mouse.x=e.clientX,this.mouse.y=e.clientY,Ht.needsRenderUpdate=!0}}class Ut extends Mt{constructor(e,t,n={}){const s=n.level||1;super("tutorial-"+s,"Dungeon Entry",e,t),this.maxRooms=n.maxRooms||1,this.roomMinSize=n.roomMinSize||8,this.roomMaxSize=n.roomMaxSize||8,this.level=s,this.minTilesByFloor=[{level:1,amount:3}],this.maxTilesByFloor=[{level:1,amount:3}],this.minMonstersByFloor=[{level:1,amount:2}],this.maxMonstersByFloor=[{level:1,amount:2}],this.minItemsByFloor=[{level:1,amount:2}],this.maxItemsByFloor=[{level:1,amount:2}],this.explored=!0}getFloorAmount(e){let t=0;for(const n of e){if(n.level>this.level)break;t=n.amount}return t}save(){const e=super.save();return 1!==this.level&&(e.level=this.level),this.saveCache=e,e}create(e,t){super.create();const n=It.createFromTemplate("wall",{components:{position:{x:0,y:0}}});for(let e=0;e<this.height;e++)for(let t=0;t<this.width;t++){const s=n.clone();s.getComponent("position").moveTo(t,e),this.tiles[t][e]=s}const s=[];for(let e=0;e<this.maxRooms;e++){const e=Q.randomInt(this.roomMinSize,this.roomMaxSize),n=Q.randomInt(this.roomMinSize,this.roomMaxSize),o=new Nt(1,1,e,n);if(o.createRoom(this),0===s.length){const e=o.getCenterX(),n=o.getCenterY();t&&t.setPosition(e,0),this.tiles[e][0]=It.createFromTemplate("stairs_up",{components:{position:{x:e,y:0}}});const s=Q.randomInt(o.x1+2,o.x2-2),i=Q.randomInt(o.y1+2,o.y2-2);this.tiles[s][i]=It.createFromTemplate("stairs_down",{components:{position:{x:s,y:i},stairsInteractable:{generator:"basic-dungeon"}}});let a=s,r=i;for(;a===s&&r===i;)a=Q.randomInt(o.x1+2,o.x2-2),r=Q.randomInt(o.y1+2,o.y2-2),a===s&&r===i||(this.tiles[a][r]=It.createFromTemplate("trap_door",{components:{position:{x:a,y:r},trapDoorInteractable:{generator:"shop"}}}));this.addPlayer(e,n);const l=It.createFromTemplate("hero");this.addActor(l)}s.push(o)}for(const e of s)e.placeTiles(this,"tutorial",this.level,this.getFloorAmount(this.minTilesByFloor),this.getFloorAmount(this.maxTilesByFloor)),e.placeEntities(this,"tutorial",this.level,this.getFloorAmount(this.minMonstersByFloor),this.getFloorAmount(this.maxMonstersByFloor)),e.placeItems(this,"tutorial",this.level,this.getFloorAmount(this.minItemsByFloor),this.getFloorAmount(this.maxItemsByFloor))}}!function(){function e(){Ht.handleEvents(),Ht.spriteManager.preloadSprites()&&Ht.needsRenderUpdate&&(At.clearAll(),Ht.draw(),Ht.needsRenderUpdate=!1),window.requestAnimationFrame(e)}const t=window.setInterval((()=>{It.isLoaded()&&(clearInterval(t),function(){Ht.clearMaps(),Ht.initTextures(),At.resizeCanvas(),Ht.setHeroMap(new Ut(11,11)),Ht.setNextMap(new Ft(11,11,{level:2})),Ht.setFutureMap(new Ft(11,11,{level:3})),Ht.setShopMap(new Ot(11,11)),Ht.player=It.createFromTemplate("player",{components:{position:{x:0,y:0}}}),Ht.heroMap.create(),Ht.nextMap.create(),Ht.futureMap.create(),Ht.shopMap.create(),Ht.playerMap=Ht.heroMap,Ht.eventHandler=new jt,I.updatePlayerDetails(Ht.player,Ht.playerMap),C.text("Welcome to the dungeon.").build(),Ht.needsRenderUpdate=!0;const t=Ht.player.getComponent("position");Ht.heroMap.revealFromPosition(t.x.get(),t.y.get(),20,0),Ht.player.fov.compute(Ht.playerMap,t.x.get(),t.y.get(),5),Ht.player.fov.updateMap(),window.requestAnimationFrame(e)}())}),0)}()},798:(e,t,n)=>{var s={"./actors/_base.json":164,"./actors/enemies.json":266,"./actors/hero.json":491,"./actors/player.json":145,"./items/_base.json":975,"./items/potions.json":353,"./tiles/_base.json":860,"./tiles/containers.json":362,"./tiles/floors.json":727,"./tiles/shop.json":819,"./tiles/stairs.json":77,"./tiles/walls.json":329};function o(e){return i(e).then(n)}function i(e){return Promise.resolve().then((()=>{if(!n.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}))}o.keys=()=>Object.keys(s),o.resolve=i,o.id=798,e.exports=o},164:e=>{"use strict";e.exports=JSON.parse('[{"id":"base_actor","type":"actor","sprite":"placeholder","components":{"blocksMovement":true,"fighter":{}}},{"id":"base_interactable","type":"actor","sprite":"placeholder","components":{"blocksMovement":false}}]')},266:e=>{"use strict";e.exports=JSON.parse('[{"id":"rat","extends":"base_actor","name":"Rat","sprite":"rltiles_giant_rat","components":{"faction":{"factions":"monsters","enemies":"hero"},"aiMeleeChase":{"radius":3,"movementActions":2},"fighter":{"baseHp":10,"baseDamage":2},"level":{"xpGiven":10}}},{"id":"rat_small","extends":"base_actor","name":"Small Rat","sprite":"rltiles_sewer_rat","components":{"faction":{"factions":"monsters","enemies":"hero"},"aiMeleeChase":{"radius":3,"movementActions":2},"fighter":{"baseHp":5,"baseDamage":1},"level":{"xpGiven":5}}},{"id":"lizard_giant","extends":"base_actor","name":"Giant Lizard","sprite":"rltiles_giant_lizard","components":{"faction":{"factions":"monsters","enemies":"hero"},"aiMeleeChase":{"radius":3,"movementActions":2},"fighter":{"baseHp":15,"baseDamage":3},"level":{"xpGiven":15}}},{"id":"web_large","extends":"base_interactable","name":"Web","sprite":"webs_cobweb_large","components":{"cleanable":{"decreasesTo":"web"}}},{"id":"web","extends":"base_interactable","name":"Web","sprite":"webs_cobweb","components":{"cleanable":{"increasesTo":"web_large"}}},{"id":"blood_large","extends":"base_interactable","name":"Pool of Blood","sprite":"scribble_blood_3","components":{"cleanable":{"decreasesTo":"blood_medium"}}},{"id":"blood_medium","extends":"base_interactable","name":"Pool of Blood","sprite":"scribble_blood_2","components":{"cleanable":{"decreasesTo":"blood_small","increasesTo":"blood_large"}}},{"id":"blood_small","extends":"base_interactable","name":"Pool of Blood","sprite":"scribble_blood_1","components":{"cleanable":{"increasesTo":"blood_medium"}}}]')},491:e=>{"use strict";e.exports=JSON.parse('[{"id":"hero","extends":"base_actor","name":"Hero","color":"#00f","letter":"@","sprite":"rltiles_barbarian","components":{"faction":{"factions":"hero","enemies":"monsters, player"},"fighter":{"baseHp":30,"baseDefense":2,"baseDamage":5},"aiHero":{}}}]')},145:e=>{"use strict";e.exports=JSON.parse('[{"id":"player","extends":"base_actor","name":"Player","color":"#00f","letter":"@","sprite":"rltiles_human","components":{"faction":{"factions":"player","enemies":"hero"},"fighter":{"baseHp":30,"baseDefense":2,"baseDamage":5},"inventory":{"items":[{"load":"potion_health"}]}}}]')},975:e=>{"use strict";e.exports=JSON.parse('[{"id":"base_item","type":"item","sprite":"placeholder","components":{}}]')},353:e=>{"use strict";e.exports=JSON.parse('[{"id":"potion","extends":"base_item","maxStackSize":20,"components":{}},{"id":"potion_health","extends":"potion","sprite":"rltiles_purple_red","name":"Health Potion","description":"Recover a minor amount of health","components":{"healingConsumable":{"amount":4}}}]')},860:e=>{"use strict";e.exports=JSON.parse('[{"id":"base_tile","type":"tile","sprite":"placeholder","components":{"blocksMovement":true,"blocksFov":true}}]')},362:e=>{"use strict";e.exports=JSON.parse('[{"id":"base_container","extends":"base_tile","components":{"blocksMovement":true,"blocksFov":false}},{"id":"barrel","extends":"base_container","name":"Barrel","color":"#ddd","sprite":"scribble_floor_barrel","components":{"lootableInteractable":{"capacity":1}}},{"id":"barrels","extends":"base_container","name":"Barrels","color":"#ddd","sprite":"scribble_floor_barrels","components":{"lootableInteractable":{"capacity":2}}},{"id":"barrels_stacked","extends":"base_container","name":"Barrels","color":"#ddd","sprite":"scribble_floor_barrels_stacked","components":{"lootableInteractable":{"capacity":3}}},{"id":"chest","extends":"base_container","name":"Chest","color":"#ddd","sprite":"scribble_floor_chest","components":{"lootableInteractable":{"capacity":5}}}]')},727:e=>{"use strict";e.exports=JSON.parse('[{"id":"base_floor","extends":"base_tile","components":{"blocksMovement":false,"blocksFov":false}},{"id":"floor","extends":"base_floor","name":"Floor","color":"#ddd","sprite":"scribble_tiles"},{"id":"floor_center","extends":"base_floor","name":"Floor","color":"#ddd","sprite":"scribble_tiles_center"},{"id":"floor_cracked","extends":"base_floor","name":"Floor","color":"#ddd","sprite":"scribble_tiles_cracked"}]')},819:e=>{"use strict";e.exports=JSON.parse('[{"id":"table","extends":"base_tile","name":"Table","color":"#ddd","sprite":"scribble_floor_table","components":{"blocksMovement":true,"blocksFov":false}}]')},77:e=>{"use strict";e.exports=JSON.parse('[{"id":"stairs_up","extends":"base_tile","sprite":"scribble_stairs_down_detail","name":"Stairs Up","components":{"blocksMovement":true,"blocksFov":false}},{"id":"stairs_down","extends":"base_tile","sprite":"scribble_stairs_down","name":"Stairs Down","components":{"blocksMovement":false,"blocksFov":false}},{"id":"trap_door","extends":"base_tile","sprite":"scribble_trap_door","name":"Trap Door","components":{"blocksMovement":false,"blocksFov":false}}]')},329:e=>{"use strict";e.exports=JSON.parse('[{"id":"base_wall","extends":"base_tile","components":{"blocksMovement":true,"blocksFov":true}},{"id":"wall","extends":"base_wall","name":"Wall","color":"#666","sprite":"scribble_wall_full"}]')}},e=>{e(e.s=734)}]);
//# sourceMappingURL=app.56568f8a5d1b7ec5448b.js.map